<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="22088" />

<meta name="date" content="2022-12-08" />

<title>HW-22088</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">HW-22088</h1>
<h4 class="author">22088</h4>
<h4 class="date">2022-12-08</h4>



<div id="hw0" class="section level1">
<h1>HW0</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Go through “R for Beginners” if you are not familiar with R
programming.</p></li>
<li><p>Use knitr to produce at least 3 examples (texts, figures,
tables).</p></li>
</ol>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code></pre></div>
<div id="for-texts" class="section level3">
<h3>For texts</h3>
<p>We can use “highlight” to control whether the code is
highlighted(True) or not(False).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">==</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<pre class="text"><code>1+1==2</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>Similarly, we can use “<strong>eval</strong>” to control whether the
code is run or not.<br />
</p>
<p>“<strong>echo</strong>”,“<strong>warning</strong>” and
“<strong>include</strong>” control whether the code, warning, and output
are displayed, respectively.</p>
</div>
<div id="for-tables" class="section level3">
<h3>For tables</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> cars</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>##   speed dist
## 1     4    2
## 2     4   10
## 3     7    4
## 4     7   22
## 5     8   16
## 6     9   10</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(df),<span class="at">align =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">speed</th>
<th align="left">dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">4</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">10</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">22</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="left">16</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left">10</td>
</tr>
</tbody>
</table>
</div>
<div id="for-figures" class="section level3">
<h3>For figures</h3>
<p>we can use the function “<strong>par()</strong>” to change the layout
of figures.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">lm</span>(speed <span class="sc">~</span> dist, <span class="at">data =</span> df))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABPlBMVEUAAAAAADUAADoAAGAAAGYAOpAAP3EAZrYZUZ4kAAAnAAArAGYuAAA6AAA6ADo6AGY6OmY6OpA6kLY6kNs/cZ5GACRMAABMADpgtv9mAABmADpmAGZmOgBmZmZmkJBmtrZmtuBmtv9swf9xPwCQOgCQOjqQkGaQtpCQtv+QztCQ29uQ2/+eiFmennGenoienp6enrCensCesNCewOClfjqwiFmwnp6wnrCwnsCwsLCwsNCw0O+2ZgC2tma225C279C2/7a2//++vr7Anp7AnrDAnsDAsNDAwZDA4ODA4P/Ql1nQqmbQsJ7QsLDQsMDQ0MDQ4NDQ7//bkDrbtmbb25Db2//b///fU2vgwJ7g79Dg///v0LDv////qlT/tmb/24b/25D/4MD/4OD/75T/79D//7b//9v//+D//+////+nXmCSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAARtElEQVR4nO2diX/kNhXHRUgIV8ox5chCWQbShRKK2y5sgUxLd8M1UKA1kAmbZZiBnWT9//8DSE+HJV9PkiWPZ6LfZ3fGh0a2v3l6epIlmxRJnSLbPoGxKwFClAAhSoAQJUCIEiBECRCiBAhRAoQoAUKUACFKgBAlQIgSIEQJEKIECFEChCgBQpQAIUqAECVAiBIgRAkQogQIUQKEKAFClAAhSoAQJUCIEiBECRCiBAhRAoQoAUKUACFKgBAlQIgSIEQJEKIECFEChCgBQpQAIUqAECVAiBIgRAkQogQIUQKEKAFClAAhSoAQlYA2p5MiJ+ToaotnM0KVgGZHV6uT42J2vMWzGaEUoM3ptFgS+v/w6TbPZ3QyAM0onDwBMqQVsePN6dHV5jQVMUO6kyYH57dniY+pKNX87RkBTRr2saLMtTw479jbqtmw9WwkQGCHzOd3KAFCyusuAaL+RylALSbJwLXkoqytTujCVCCgGw8eHZzDCnzMYCcsi4TwE/ZFQZabdEA8Z5VIHmnz4BG7iJn8yYwfqzwTJ0W3oJye2upEXActdBwHvYAl0QDNREq6LBOqfGZH/yg3aYBEzjLRlTwSq4wLlaM6ljoTN8UElIPBsDOi0acMQLmNsGudlYA2D865vdBlPVJlQRnNwQheJSCVs0ik1mFB5agdS+x3uxajmg9XxHhWU+lo6FluTnnGELHD4lIvYsxCeAGUCVVilkw7KQlIyxkSGeuFylEdS+13uxajLZYfu2fQJLAg1rCDkxSsgBr3QXkNEHUPhx9yC5IJ+UkdAxBjkwSkcuaJ1LrycpCjOlaZ3klaU2NSLOmx8wCVBC9iS+YRzapKlKqaBcGfRRQxmRC+l4cfSXuQm0wLKhOpdchD5VixIGcZbbHVV57C/74SPmjGva62A0qQ9Au58At0Da5iSUpA5fcbsnQpdsoHTVWub4AbmmoJVY7asbzKhgJ0ezYBzxYQEFQnvCYRf0BpNGzjElo2R1e0+Ey58ZAJOGmRkGc1I8dibVmxIJWzSKTWlQVBjmYtpuzQHRAU1tkkYBFjfmDCow/+5yREmZSIg6BmeMh90MG5LIA8IRev3PVNM9WMkTnLCECsl0c4F/jI4QcsnUrvIq2ap76Onu9+9nb493LtfZ80+CAeA3lp7wHxcMA/dtFqsXBtsX1S1YJSl3RFtSKW7mqYqgFKJmSqBqjfXQ0yjLL+WfgC6nlXY7hKMcuyPj93ByRrsX6B9KBRQx9E3hbUUzy7Z2Ez7ZIvpHsDSCByxuQIKFin/dYC88zRJ3lYEPRvNd6LiXHcOLJn5A5IdVH08tJbKGKGrA3JpxbjDbp+gWIbIIfAI4AynJOPBfEegX43LluOS1xOKZw6IHn5INF52+eUmo9L3M4pnLLWKs6nmoeqrGeHa3MR2xogoYYSx0/m7jJ77wUs3dAk7z5v+O0gcdC2AXEZnglO5tXH8+LmMaxfz1t+FeassTagU/MwsjgnOJu73z0vXv6S2c2rv3zakjyKBdU3jwgQF5zNy1+/KO5+y9DQspZl89aE/N5/uEh6nEXMEJzM+j0J6OX7n7ZY0T3yQYYqFgRq9EODFLGxAip9EAgBFGQqwrgCxQ6JWuxC1GKssL36a3c1H2QqQksRG52PNuIgZkQ0DnqnsSILPBWhEdD47Me3sdp/KkLTcUfogbyaGkGmIuwzoCBTEZqKWB3QCDzSqPqkqz5oDD5pu4BqW0mVz9YJeXZ3HF3NvAfStB+3YjG7Cmh5cJ4zJ92LUJsPUjakIqKdA8S6XFmHfYhqvgaI/SNyP9lNHwTDuSmgEIFiZZvoKSKqdO1kLSYtKHynPcAxAPU4QCh5+6C8Yzifxf3XhiJGRFOMyKK2ffMpenTad97UuD1r42J2udYBFYQfiShv1JaP7Yn3VKQ4CA20G7IjRLMb/t120AG9t58PwoVMQ20GJI2IkG4nNKSH8qvFQh232QcVpOiOgcYNKMzozXYfREr/01XCxgso5F2N6jZhQEQud/16tD4o2nFFESM2l7/ztZhlds+qm6ThjCEC4hoXoIWqxcqtWw4XR1TEgBCpOJitm9OYAFFrWRQykNZrqm0SGlERExYkXFFBymQ7BCjwMOCak6aEiOoYKnYQEFOsYcB800KZT9lx1udAfeXTFgs3DLi6idrlQrT1lReyqcUiVnX+bbHwt56By6IgRr+HZWbREPm35kP0KFYBEYiFXMNF4bLiEPLyQZGGARMRLKrWvDUgoj6Dy6eaDzcMuLoNitaiBGRnFaMDFO649VvPgtCCy/KwZWgQXgMDUkHUM8rmGf3g3/I/287+L+RyZX/bf8iP2KV1/O9ZxKLcepZRIWtwcLNYWJebEdViIW89N21T/dGidd/nKAHkV83HufVcdpmJFd66h5WtgfILFEPdem4ZxAmVkgisVeotEfK3oAjzxcp2qrxFJtwRfqpQ5cWQtw/quvXse1yjIS/MaVFYAAI6iyiQvAPFfoF0exxU6+lYIIAMLuEhjSpQlE0qrZ0h2x7NJ9DIIyyk7QKqb9ZrMfm50GsxtdTJIRwkn1qM9weFH0CldpDKknaxYqPN9YeB5ANIPHIv4rRwoi2D5JXWgCHqD8kH0MNTeJ5jDECtzc5FGRAtFm7FvR8kr0Dx9oxMohQx0XHRGDYvRIVv28Sv/NgXkl8kXeTk6O9RAMlOoaa97Bqtu0Cafu4DyRMQe1x6hLZY2VtPGvYAnn6tMndGvoAK49nWFfkN4pT9ZXoUpFX5oeIMR0OKEwe1DuLsyk62L7SVQmcTMBJzgBQpUPQaxCk+FRLFJTggJktIjoCs583bDeKs33pWbfkiNiAmC0gDNzW6xknXPI3pfyLwASGQRtUWq9ZQjUF1DHVAci5iDqM7ukZUtzdWO1ajqgWShwVZj+7AATU9mmI4JHU1QHIHZD+6wxmQKk7IWUU1rAok70DRoi3mXMQso8L4dqZB8rEg29EdfoDQcQvRKn1TotPAywcFG93R7oM6AbU2ZwPKObrQEsZ7yJs+G6r9p0R+RFQlSLX+ReATaNvVNVcsGqDbs2nZS9EDkN18MevsmvZ1u6FYRSyXr6RihaMHoGjzxao72wF17fXW6qvfnRarr13xV7L18UGx5otVd7aXsa6dvrp98ydnOiDMjhvPChRvvpi5t8tLRfBA+YT5IChiRv08QicNu4ce7kJNRzrpr785HkDWz5OODiyHQgHVz+Y7etHgx3V6lmuQl0C6ARqkEQtFjPqf3OgMhcO6Pcs1yEsgnS53mMYFFLFlNQSGozo9yzXMSyD9ALEX8YYIMmxFixMc2/5ZrkXPl0B2drm2/0p8wqsVX+s3MMlO5QO44dhOz3IN8xJILx+0hHcRD2BC2lO3KxYEQh5VGuQlkI4OpazFRBgXRw0vAaj4IBD2sNsQL4H09bhhWoI1tb8eQdRiLs9yDSLHOEiq5/D1JiEvjtDjILtnuYaRO6BXH2fZT7/w7aZdd5cX8L1uOnW68e5yrq3Pjd3Y60ccI+ntvdtnnV0UK/L5nzX99TBAZto5fFu8cwTk1eW6hXf7vHwyl0FCvRaTgDQ/WqoOyOn1Rz4dZtt4t88NdQHsN/99Tpg1ZRkgEQsA6Ca7uPs99RNPtEiOOYy/iSIGOzL2SbO65onuLv94yVOzJtZj8X1RP1HrKypiv9unRa8+flzGi2t6SXeXjwu1wADdcCpgaWtB6Jq2KtcZB0R3MEBzgHVNf3xDLevukn7ciP+QC/1++UQn5N/lGnSuhvQIbd9gIwLQqz99kZaz9Tt/JuSzT4UTvpBM1lpLG2AV1wBINcEZIIj52F7Ili7IMsq/9Ty2fNvHWvzMeUD9v2/8gDY43vrFl37z5OfH4vp+JcvF3WV5dfxCGUAKWe6QTnqdgfnNYQtHKf2VXHM70WFu+7QJipgIqP/9uTm13++zy/oDbe7Q66Ml5ZP3P5UplQ+6oUiyTBQxuQOWqad5919PNEDi1+uMa1490ZYKoH5FweTjpJloUWJ/4M2Dt57QBWVBF8W1SMB0zSsuakGZGQddK38ki9i8wYIaTpQet7GXrJ7QRcuOOUFe1Twzg/de0Lif+kF6Lf/58mfOpQ8yygVcNzUE2HSjAQJrm/Oyt9aKWOmDykyME71+5xN7C7o9wwPFGSETuEPQdo/IK1CkfNifeP32Nye8Fnv7W+eyFoMqS9gA+2CundVJshaTOyRM2ni4UIAgJSvG7FsaYFH2BxVORWyG1++shpuB9bRFS+5NDeiqgnK0OnldxkE/fF3FQYBMuBF5gXoctM54K+qaZgINKlHelFdScRAvTCKadAdk0V4Eu+E9W23RkmdjlUl09rJezaa+j56vLla5iAUfQGiPFWd4+88CsyAv5aLBkfee9tikahvNHZDNCyPUlPFWc4vSA9/XeJp+7uGDsCHQTCKMrCX165O2VM+i1UzXp4gF6e4APSOhlPV5s3zW9WvrK3KHgHePWmYaNFnYY/b4wf0FZH3r+b4Csr71fE8B2d96vreAetx69juL3QIU5taz01nsFqAwt56dzmLHAAW59ex0FrsGKKlJpZMWXQxBRgPvkWqA+j3kbf8kAM3KVlyUcSi7q5oFJZlKThqRBLQ6mXTf0LmvEoCgjco6CnuOk94/SScNA01ZBdbvder7JznCbCK77VMcZEoCmspbFQmQKQ0Qdz8hGqv7JM0HwT2dvu9T3zsJQMuD880psx2LO/RNMgIEteIbNlR+J7qoPHPTfwYDNCZOmck4iM8XWp34FTA2NlaNj1Urxlbf3NRj1Txz0392e0YXcnLsklmQSJr3UosAQa0YW31zgz8dA+SZm/Ez4WUPnzpkFgSQOrCxYmz1zY0N34aK1TO3hp9Ry3HILAwgfUiMWukeKGOZWyEXPXNr+NnM6dSCAOKlWZRptWJs9c0NNrAL8cyt/jM2o8Ahs3sHaCl99JCAdqiI8RkpQxexmE66kICCOOmcR0FDO+mo1bwAFKKaL+Q7H4au5uMGiqIoBAgUoVew8RDtCtTlKkZe8pacGobpOx7TyE35Cs/ctMz4OFFYtc4s9UkjSoAQJUCIEiBECRCiBAhRAoQoAUKUACFKgBAlQIgSIEQJEKIECFEChCgBQpQAIUqAECVAiBIgRAkQogQIUQKEKAFClAAhSoAQJUCIxgCo37MtIysBQpQAIRoXoBwGwvPxX0sY9A0D4zcPHrGx0mxiLQyAogsHj8QglthzbEcFiM0WWZ1M+Lgg9jQavl6IWRJyPgmbLrFkw3vk/pgaEyA1H4sNHoTXT4t1WIBZx8y4uIHN2OySAeZvjQkQHxNHr5/NzlLjiMU6T8HKmBqRp/bHPLlRARIz96esNNGNap0Dog7n8ENKI1eAVPqIGhUgNWpwefgRNyK+Ws73Yx8VC4qsMQEqHwa6OX0D3NC0KHfw8fZqYnbOfNAAM7THBEjUUfBBjrV1ZUGbU1arG7WYePpuNI0CkHpoSC6fwiee9SnWlQ86OBf4yOEHLJ1KH09jAOSloWZn7yAg8EER3gbUrB0ExMOBoZ6gsYuABlUChCgBQpQAIRoSUD3yhXegWqq9YbGsBNXLacAHjm0XUO4wgbATUO0wy1C9lFsF5NSYcgPkYpudGhjQ6uThKXu7C381r5itC1HN6rUfnYj+U9WRqi/wPtaaxB7RWmM5sc/ebxwuNTgg6GmmYODZusfl09PodU15E0x1pKoF1TqtSe6Bhz2LnLhdhuoLGRzQRMythY7CSdmm4n3L9O9udrTCBHzZx8rSsSfcsOfU/Jj/SPW+TlVOHFCojsbBAWldX+LBYPp0e70jtVxQs54LqKJYa54XILWHZSVz4oBCNda2CYgzgYceTeXDELSOVLWQ64AM5TogmdP+ACorMVpISkD6/Hu+0ArIsCCZ0z4Bmuh74GEIzAfpHa1Mqo+1lmO995Uu7I8PglpMPqMB6jdVi4FLNhaaazG5ZyP7+Jfqdtmu1mK1+xNL/iyE1cn3TojR0WouWMRBIifqw3c0DqpJj6QD3/8Ldsdju615rS0WGNBOtsXq0lpMYQHtZmt+J5UAIfo//ix3OaDElkkAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">lm</span>(speed <span class="sc">~</span> dist, <span class="at">data =</span> df))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
</div>
<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.3, 3.7, 3.12, and 3.13 (Statistical Computating with
R)</p>
<div id="answer-for-exercises-3.3" class="section level3">
<h3>Answer for exercises 3.3</h3>
<p>First,we derive <span class="math inline">\(F^{−1}(U)\)</span>, we
can get <span class="math inline">\(X=b*(1-U)^{-1/a},0\le U&lt;
1,a&gt;0\)</span> from <span class="math inline">\(U=F(X)=1-(\frac{b}{X})^a,X\ge
b&gt;0,a&gt;0\)</span>. Then, we use the inverse transform method to
simulate a random sample from the Pareto(2, 2) distribution, which means
a=b=2. Finally, we graph the density histogram of the sample with the
Pareto(2, 2) density superimposed for comparison.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="do">## a function generate random samples from pareto distribution by inverse transform method</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>rpareto<span class="ot">&lt;-</span><span class="cf">function</span>(n,a,b){</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>b<span class="sc">*</span>((<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>a))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20000407</span>)  <span class="do">##choose a seed for my homework</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rpareto</span>(n,<span class="dv">2</span>,<span class="dv">2</span>)  <span class="do">##a=b=2</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">8</span><span class="sc">/</span>(x<span class="sc">^</span><span class="dv">3</span>)))</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(x), .<span class="dv">01</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="dv">8</span><span class="sc">/</span>(y<span class="sc">^</span><span class="dv">3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="answer-for-exercises-3.7" class="section level3">
<h3>Answer for exercises 3.7</h3>
<p>We assume that <span class="math inline">\(a&gt;1, b&gt;1\)</span> in
Beta(a,b), the pdf is <span class="math inline">\(f(x)=\frac{1}{B(a,b)}x^{(a-1)}(1-x)^{b-1}.\)</span></p>
<p>We noticed that <span class="math display">\[(a-1)(b-1)x+(b-1)(a-1)(1-x)\ge(a+b-2)[(b-1)^{a-1}(a-1)^{b-1}x^{a-1}(1-x)^{b-1}]^{1/(a+b-2)},\]</span>then
we have<span class="math display">\[\frac{1}{B(a,b)}x^{a-1}(1-x)^{b-1}\le\frac{1}{B(a,b)}(\frac{(a-1)(b-1)}{a+b-2})^{a+b-2},\]</span>so
we choose <span class="math inline">\(g(x)=1,0&lt;x&lt;1\)</span> and
<span class="math inline">\(c=\frac{1}{B(a,b)}(\frac{(a-1)(b-1)}{a+b-2})^{a+b-2}\)</span>
to use acceptance-rejection method.</p>
<p><span class="math inline">\(\rho(x)=f(x)/cg(x):\)</span> <span class="math display">\[\rho(x)=f(x)/cg(x)=x^{a-1}(1-x)^{b-1}/(\frac{(a-1)(b-1)}{a+b-2})^{a+b-2}\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## the function rho(x) with parameter a and b</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>rho<span class="ot">&lt;-</span><span class="cf">function</span>(x,a,b){</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">&lt;-</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(b<span class="dv">-1</span>)<span class="sc">/</span>(a<span class="sc">+</span>b<span class="dv">-2</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">&lt;-</span>c<span class="sc">^</span>(a<span class="sc">+</span>b<span class="dv">-2</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>(x<span class="sc">^</span>(a<span class="dv">-1</span>))<span class="sc">*</span>((<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>))<span class="sc">/</span>c</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="do">## a function generate random samples from beta distribution by acceptance-rejection method</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>my_rbeta<span class="ot">&lt;-</span><span class="cf">function</span>(n,a,b){</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g(.)</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">rho</span>(x,a,b) <span class="sc">&gt;</span> u) {</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#we accept x</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>      y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">my_rbeta</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">2</span>)  <span class="do">##n=1000,a=3,b=2</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">12</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>(<span class="dv">1</span><span class="sc">-</span>x)))</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="dv">12</span><span class="sc">*</span>(y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,z)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="answer-for-exercises-3.12" class="section level3">
<h3>Answer for exercises 3.12</h3>
<p>First, we get <span class="math inline">\(\Lambda\)</span>, then we
get <span class="math inline">\(Y\)</span> based on <span class="math inline">\(\Lambda\)</span>. We define a function ‘EG’ to
simulate Exponential-Gamma mixture.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>EG<span class="ot">&lt;-</span><span class="cf">function</span>(n,r,beta){</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span><span class="fu">rgamma</span>(n,r,beta)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,lambda)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>Y_eg<span class="ot">&lt;-</span><span class="fu">EG</span>(<span class="dv">1000</span>,<span class="dv">4</span>,<span class="dv">2</span>) <span class="do">##Generate 1000 random observations, r=4,beta=2</span></span></code></pre></div>
</div>
<div id="answer-for-exercises-3.13" class="section level3">
<h3>Answer for exercises 3.13</h3>
<p>Similar to exercise 3.3, we can get <span class="math inline">\(Y=\beta*(1-U)^{-1/r}-\beta,0\le U&lt; 1\)</span>,
we still use function ‘rpareto’.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">rpareto</span>(n,<span class="dv">4</span>,<span class="dv">2</span>)<span class="sc">-</span><span class="dv">2</span>   <span class="do">##r=4,beta=2</span></span></code></pre></div>
<p>We use function ‘hist’ to compare the empirical and theoretical
distributions. The theoretical Pareto density: <span class="math inline">\(f(y)=\frac{64}{(2+y)^5}.\)</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(y)<span class="sc">==</span><span class="dv">64</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>y)<span class="sc">^</span><span class="dv">5</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(y), .<span class="dv">01</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="dv">64</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>x)<span class="sc">^</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Homework in PPT (Page 7, Monte_Carlo_Integration).</p></li>
<li><p>Exercises 5.6 (Page 150, Statistical Computing with R).</p></li>
<li><p>Exercises 5.7 (Page 150, Statistical Computing with R).</p></li>
</ol>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="homework-in-ppt" class="section level3">
<h3>Homework in PPT</h3>
<p><strong>Problem.</strong></p>
<p>For <span class="math inline">\(n = 10^4, 2 × 10^4, 4 × 10^4, 6 ×
10^4, 8 × 10^4\)</span>, apply the fast sorting algorithm to randomly
permuted numbers of <span class="math inline">\(1,\dots,n\)</span>.
Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>, then regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=
n\log(n)\)</span>, and graphically show the results (scatter plot and
regression line).</p>
<p><strong>Solution.</strong></p>
<p>First, we give the fast sorting algorithm, defined as
‘quick_sort’.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)}</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]  <span class="do">##Without loss of generality, we take the first number.</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))} <span class="do">##Nested functions step by step</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We apply ‘quick_sort’ to randomly permuted numbers of <span class="math inline">\(1,\dots,n\)</span>, where <span class="math inline">\(n = 10^4, 2 × 10^4, 4 × 10^4, 6 × 10^4, 8 ×
10^4\)</span>, corresponding to <span class="math inline">\(n_1,\dots,n_5\)</span> respectively.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">407</span>)  <span class="do">##a seed for my homework</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">1e4</span>,<span class="fl">2e4</span>,<span class="fl">4e4</span>,<span class="fl">6e4</span>,<span class="fl">8e4</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n[i]) <span class="do">##randomly permuted numbers of 1,...,n</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quick_sort</span>(test)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then, we calculate computation time averaged over 100 simulations,
denoted by <span class="math inline">\(a_1,\dots,a_5\)</span>,
corresponding to <span class="math inline">\(n_1,\dots,n_5\)</span>
respectively.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  a[i]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){  <span class="do">##100 simulations</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n[i])</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    a[i]<span class="ot">&lt;-</span>a[i]<span class="sc">+</span><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  a[i]<span class="ot">&lt;-</span>a[i]<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] 0.0287 0.0572 0.1188 0.1768 0.2422</code></pre>
<p>Finally, we regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n=n\log(n)\)</span>, and show the results.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">log</span>(n)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>lm<span class="ot">&lt;-</span><span class="fu">lm</span>(a<span class="sc">~</span>t)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm)<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">4</span>]  <span class="do">##p-value</span></span></code></pre></div>
<pre><code>## [1] 2.043916e-06</code></pre>
<p>As can be seen from the P-value, there is a strong linear correlation
between <span class="math inline">\(a_n\)</span> and <span class="math inline">\(t_n\)</span>. Next, we show scatter plot and
regression line, which can also prove the linear correlation.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span>lm<span class="sc">$</span>coefficients[[<span class="dv">1</span>]]  <span class="do">##intercept</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span>lm<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]  <span class="do">##slope</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t,a)  <span class="do">##scatter plot</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(b,k)  <span class="do">##regression line</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-5.6" class="section level3">
<h3>Exercise 5.6</h3>
<p><strong>Problem.</strong></p>
<p>We consider the antithetic variate approach for Monte Carlo
integration of <span class="math display">\[\theta=\int_0^1e^xdx.\]</span> Compute <span class="math inline">\(Cov(e^U, e^{1−U})\)</span> and <span class="math inline">\(Var(e^U + e^{1−U})\)</span>, where <span class="math inline">\(U\sim\)</span> Uniform(0,1). What is the percent
reduction in variance of <span class="math inline">\(\hat\theta\)</span>
that can be achieved using antithetic variates (compared with simple
MC)?</p>
<p><strong>Solution.</strong></p>
<p>Easily, we have <span class="math display">\[\mathbb{E}e^U=\mathbb{E}e^{1-U}=e-1\]</span> and
<span class="math display">\[Var(e^U)=Var(e^{1-U})=\frac{e^2-1}{2}-(e-1)^2.\]</span>
So,<span class="math display">\[Cov(e^U,e^{1-U})=\mathbb{E}(e^Ue^{1-U})-\mathbb{E}e^U\cdot\mathbb{E}e^{1-U}=e-(e-1)^2,\]</span>then,
<span class="math display">\[\begin{aligned}Var(e^U,e^{1-U})&amp;=Var(e^U)+Var(e^{1-U})+2Cov(e^U,e^{1-U})\\&amp;=2(\frac{e^2-1}{2}-(e-1)^2)+2(e-(e-1)^2)\\&amp;=-3e^2+10e-5.\end{aligned}
\]</span></p>
<p>We define that <span class="math inline">\(\hat\theta\)</span> is
estimated by the simple Monte Carlo method, and <span class="math inline">\(\hat\theta_a\)</span> by the antithetic variate
approach. Assume the random sample size is 2m. We have: <span class="math display">\[\hat\theta=\frac{1}{2m}\sum_{i=1}^{2m}e^{U_i},U_i\sim
U(0,1)\]</span>and<span class="math display">\[\hat\theta_a=\frac{1}{2m}\sum_{i=1}^{m}(e^{U_i}+e^{1-U_i}),U_i\sim
U(0,1).\]</span>Variance of them are:<span class="math display">\[Var(\hat\theta)=\frac{1}{2m}Var(e^U)=\frac{1}{2m}(\frac{e^2-1}{2}-(e-1)^2)\]</span>and<span class="math display">\[Var(\hat\theta_a)=\frac{1}{4m}Var(e^U+e^{1+U})=\frac{1}{4m}(-3e^2+10e-5).\]</span>So,
the percent reduction in variance of <span class="math inline">\(\hat\theta\)</span> that can be achieved using
antithetic variates (compared with simple MC) is:<span class="math display">\[\frac{Var(\hat\theta)-Var(\hat\theta_a)}{Var(\hat\theta)}=\frac{2e^2-6e+2}{-e^2+4e-3}=0.9676701\]</span>
We calculated that in R:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>e<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="dv">1</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span><span class="dv">2-6</span><span class="sc">*</span>e<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="sc">-</span>e<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">4</span><span class="sc">*</span>e<span class="dv">-3</span>)</span></code></pre></div>
<pre><code>## [1] 0.9676701</code></pre>
</div>
<div id="exercise-5.7" class="section level3">
<h3>Exercise 5.7</h3>
<p><strong>Problem.</strong></p>
<p>Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6.</p>
<p><strong>Solution.</strong></p>
<p>First, we wrote a function ‘MC.theta’ in order to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
or the simple Monte Carlo method.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>MC.theta <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">R =</span> <span class="dv">10000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (antithetic) v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u <span class="cf">else</span> v <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">exp</span>(u)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">mean</span>(g)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  cdf</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We estimated <span class="math inline">\(\theta\)</span> for 1000
times by the two methods, calculated the average of them.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">407</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> MC2 <span class="ot">&lt;-</span> Reduction <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  MC1[i] <span class="ot">&lt;-</span> <span class="fu">MC.theta</span>(<span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>) <span class="do">##simple MC</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  MC2[i] <span class="ot">&lt;-</span> <span class="fu">MC.theta</span>(<span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>) <span class="do">##antithetic</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(MC1),<span class="fu">mean</span>(MC2))</span></code></pre></div>
<pre><code>## [1] 1.718790 1.718202</code></pre>
<p>Then, we computed an empirical estimate of the percent reduction in
variance using the antithetic variate.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">var</span>(MC1)<span class="sc">-</span><span class="fu">var</span>(MC2))<span class="sc">/</span><span class="fu">var</span>(MC1)</span></code></pre></div>
<pre><code>## [1] 0.9676946</code></pre>
<p>It was very close to the theoretical value(0.9676701 ) from Exercise
5.6.</p>
<p>#HW3</p>
</div>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 5.13 (Page 151, Statistical Computing with R).</p></li>
<li><p>Exercises 5.15 (Page 151, Statistical Computing with R).</p></li>
</ol>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="exercise-5.13" class="section level3">
<h3>Exercise 5.13</h3>
<p><strong>Problem.</strong><br />
Find two importance functions <span class="math inline">\(f_1\)</span>
and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\quad
x&gt;1.\]</span>Which of the two importance functions should produce the
smaller variance in estimating <span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span>by
importance sampling? Explain.</p>
<p><strong>Solution.</strong><br />
Given the form of <span class="math inline">\(g\)</span>, it’s natural
to think that <span class="math inline">\(f_1\)</span> is a normal
distribution. However, when <span class="math inline">\(x\)</span>
becomes large, <span class="math inline">\(x^2\)</span> becomes much
larger than <span class="math inline">\(e^{-x^2/2}\)</span>. In order to
eliminate <span class="math inline">\(x^2\)</span>, we adopt a gamma
distribution with shape = 3 and scale = 1, which have a density
function: <span class="math display">\[f_2(x)=\frac{1}{\Gamma(3)1^3}x^{3-1}e^{-x/1}=\frac{1}{2}x^2e^{-x},\quad
x&gt;0.\]</span> They are positive on the set <span class="math inline">\(x&gt;1\)</span> where <span class="math inline">\(g(x)&gt;0.\)</span></p>
<p>First, following the courseware in Chapter 3, we draw the density
functions of <span class="math inline">\(g,f_1,f_2\)</span> and the
function <span class="math inline">\(g/f_1,g/f_2\)</span>, which are
figure A and B respectively.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">12</span>, .<span class="dv">01</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> (x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(f[<span class="dv">1</span>](x)<span class="sc">==</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)),</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(f[<span class="dv">2</span>](x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x}<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(1,2))</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="do">##figure A</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">1</span>,<span class="at">main=</span><span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, f1, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, f2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd =</span> w, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">##figure B</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g<span class="sc">/</span>f1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="at">lwd =</span> w, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">main=</span><span class="st">&#39;(B)&#39;</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> w, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>According to figure B and the idea of importance sampling method,
<strong>we can see that <span class="math inline">\(f_2\)</span> should
produce the smaller variance because it is closer to <span class="math inline">\(g\)</span> than <span class="math inline">\(f_1\)</span>(the ratio <span class="math inline">\(g(x)/f_2(x)\)</span> is nearly constant)</strong>.
Next, we calculate their variances.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">407</span>) <span class="do">## seed for my homework</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> va <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(<span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span>(x <span class="sc">&gt;</span> <span class="dv">1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m) <span class="do">## f1</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>fg1 <span class="ot">&lt;-</span> <span class="fu">g</span>(x1)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg1)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>va[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">var</span>(fg1)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m,<span class="at">shape =</span> <span class="dv">3</span>,<span class="at">scale =</span> <span class="dv">1</span>) <span class="do">## f2</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>fg2 <span class="ot">&lt;-</span> <span class="fu">g</span>(x2) <span class="sc">/</span> ((x2<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x2)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg2)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>va[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">var</span>(fg2)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="do">## results</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">est=</span><span class="fu">round</span>(est,<span class="dv">5</span>), <span class="at">va=</span><span class="fu">round</span>(va,<span class="dv">5</span>))</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;f&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>##          f1      f2
## est 0.39588 0.39989
## va  1.28949 0.20766</code></pre>
<p>From the results, we can draw the same conclusion as before.</p>
</div>
<div id="exercise-5.15" class="section level3">
<h3>Exercise 5.15</h3>
<p><strong>Problem.</strong><br />
Obtain the stratified importance sampling estimate in Example 5.13 and
compare it with the result of Example 5.10.</p>
<p><strong>Solution.</strong><br />
We want to compute <span class="math inline">\(\int_0^1
\frac{e^{-t}}{1+t^2}dt\)</span> by stratified importance sampling.</p>
<p>Importance function <span class="math inline">\(f(x)=e^{-x}/(1-e^{-1}),0&lt;x&lt;1\)</span> has
distribution function<span class="math display">\[F(x)=\int_0^xf(t)dt=(1-e^{-x})/(1-e^{-1}),0&lt;x&lt;1.\]</span>
So,<span class="math display">\[F^{-1}(t)=-\ln[1-(1-e^{-1})t],0&lt;t&lt;1.\]</span>
For the stratified importance sampling estimate, divide <span class="math inline">\([0,1]\)</span> into 5 intervals <span class="math inline">\(I_j = \{x : a_{j−1} \le x &lt; a_j\}\)</span> with
endpoints <span class="math display">\[a_0=0,\qquad a_5=1\]</span> <span class="math display">\[a_j=F^{−1}(j/5)=-\ln[1-(1-e^{-1})\frac{j}{5}], j
= 1, \dots,4.\]</span>On each subinterval define <span class="math inline">\(g_j(x)=g(x)\)</span> if <span class="math inline">\(x\in I_j\)</span> and <span class="math inline">\(g_j(x) = 0\)</span> otherwise. We now have 5
parameters to estimate, <span class="math display">\[\theta_j=\int_{a_{j-1}}^{a_j}g_j(x)dx,\quad
j=1,\dots,5\]</span> and <span class="math inline">\(\theta=\theta_1+\dots+\theta_5.\)</span><br />
On each subinterval <span class="math inline">\(I_j\)</span>, the
conditional density <span class="math inline">\(f_j\)</span> of <span class="math inline">\(X\)</span> is defined by <span class="math display">\[\begin{aligned}f_j(x)&amp;=f_{X|I_j}(x|I_j)=\frac{f(x,a_{j-1}\le
x&lt;a_j)}{P(a_{j-1}\le x&lt;a_j)}\\&amp;=\frac{f(x)}{1/k}=kf(x),\quad
a_{j-1}\le x&lt;a_j.\end{aligned} \]</span> Let <span class="math inline">\(σ^2_j = Var(g_j(X)/f_j(X))\)</span>. For each
<span class="math inline">\(j = 1,\dots, 5,\)</span> we simulated an
importance sample size <span class="math inline">\(m=10000/k=2000\)</span>, where <span class="math inline">\(M=10000\)</span> is the sample size of importance
sampling. Then we computed the importance sampling estimator <span class="math inline">\(\hatθ_j\)</span> of <span class="math inline">\(θ_j\)</span> on the <span class="math inline">\(j^{th}\)</span> subinterval, and computed <span class="math inline">\(\hatθ_{SI} = \sum^5_{j=1} \hatθ_j\)</span>.
Finally, by independence of <span class="math inline">\(\hatθ_1,\dots,\hatθ_5\)</span>, <span class="math display">\[Var(\hatθ_{SI})=Var(\sum^5_{j=1}\hatθ_j)=\sum_{j=1}^5\frac{\sigma_j^2}{m}=\frac{1}{m}\sum_{j=1}^k\sigma_j^2.\]</span>
First, we gave the results in Example 5.10:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">407</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(M) <span class="do">## inverse transform method</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span></code></pre></div>
<p>Then we gave the results using stratified importance sampling:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">407</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span>M<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>j<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> j <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>theta_si<span class="ot">&lt;-</span>var_si<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){  <span class="do">## stratified sampling, k=5</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span> a[i]) <span class="sc">*</span> (x <span class="sc">&lt;</span> a[i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="do">## inverse transform method</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a[i]) <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="dv">5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  theta_si[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  var_si[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(fg)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>theta.si<span class="ot">&lt;-</span><span class="fu">sum</span>(theta_si)  </span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>se.si<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(var_si))</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="do">## results</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">theta=</span><span class="fu">round</span>(<span class="fu">c</span>(theta.hat,theta.si),<span class="dv">7</span>), <span class="at">se=</span><span class="fu">round</span>(<span class="fu">c</span>(se,se.si),<span class="dv">7</span>))</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">&#39;Importance&#39;</span>,<span class="st">&#39;stratified importance&#39;</span>))</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>##       Importance stratified importance
## theta  0.5242186             0.5248919
## se     0.0967111             0.0091620</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>The estimations of <span class="math inline">\(\theta\)</span> are
consistent, and the variance of Example 5.13 was reduced to one tenth of
Example 5.10.</p>
<p>#HW4</p>
</div>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 6.4 (Page 180, Statistical Computing with R).</p></li>
<li><p>Exercises 6.8 (Page 181, Statistical Computing with R).</p></li>
<li><p>Discussion.</p></li>
</ol>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="exercise-6.4" class="section level3">
<h3>Exercise 6.4</h3>
<p><strong>Problem.</strong><br />
<span class="math inline">\(X_1,\dots,X_n \sim
LogN(\mu,\sigma^2)\)</span>, <span class="math inline">\(\mu,\sigma\)</span> unknown. Construct a 95%
confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain
an empirical estimate of the confidence level.</p>
<p><strong>Solution.</strong></p>
<p><span class="math inline">\(X\sim LogN(\mu,\sigma^2)\)</span> means
<span class="math inline">\(logX\sim N(\mu,\sigma^2)\)</span>.</p>
<p>When <span class="math inline">\(\sigma\)</span> is unknown, we have
<span class="math display">\[\frac{\sqrt{n}(\bar{logX}-\mu)}{S_{logX}}\sim
t_{n-1},\]</span>so we can get 95% CI for <span class="math inline">\(\mu\)</span>:<span class="math display">\[\bar{logX}\pm
t_{n-1}(\alpha/2)\frac{S_{logX}}{\sqrt{n}}.\]</span> Then we use a Monte
Carlo method to obtain an empirical estimate of the confidence
level.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>) <span class="co">#choose a seed for my homework</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="do">## some parameters</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>miu<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>CL<span class="ot">&lt;-</span><span class="dv">0</span> <span class="co">#empirical confidence level</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Monte Carlo</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">rlnorm</span>(n,<span class="at">meanlog =</span> miu,<span class="at">sdlog =</span> sigma)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  miu_hat<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">log</span>(X))</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  S<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(<span class="fu">log</span>(X)))</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>,<span class="at">lower.tail =</span> F)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  miu_delta<span class="ot">&lt;-</span>t<span class="sc">*</span>S<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  CL<span class="ot">&lt;-</span>CL<span class="sc">+</span>(miu<span class="sc">&lt;</span>miu_hat<span class="sc">+</span>miu_delta)<span class="sc">*</span>(miu<span class="sc">&gt;</span>miu_hat<span class="sc">-</span>miu_delta)<span class="sc">/</span>m</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>CL</span></code></pre></div>
<pre><code>## [1] 0.949</code></pre>
<p>The empirical estimate of the confidence level was closed to
0.95.</p>
</div>
<div id="exercise-6.8" class="section level3">
<h3>Exercise 6.8</h3>
<p><strong>Problem.</strong><br />
Refer to Example 6.16. Repeat the simulation, but also compute the F
test of equal variance, at significance level <span class="math inline">\(\hat\alpha=0.055\)</span> Compare the power of the
Count Five test and F test for small, medium, and large sample
sizes.</p>
<p><strong>Solution.</strong><br />
We put the code in book here, and added F-test into it.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.055</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>power<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">ncol =</span> <span class="fu">length</span>(n))</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    Fp <span class="ot">&lt;-</span> <span class="fu">var.test</span>(x, y)<span class="sc">$</span>p.value</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">count5test</span>(x, y),<span class="fu">as.integer</span>(Fp<span class="sc">&lt;</span>alpha))</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  power[,i]<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(result)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(power)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;n=10&quot;</span>,<span class="st">&quot;n=100&quot;</span>,<span class="st">&quot;n=1000&quot;</span>)</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(power)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Count Five test&quot;</span>,<span class="st">&quot;F test&quot;</span>)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>power</span></code></pre></div>
<pre><code>##                  n=10 n=100 n=1000
## Count Five test 0.122 0.823  0.999
## F test          0.230 0.974  1.000</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>From the result, we can see that the power of the Count Five test is
smaller than F-test for small, medium and large sample sizes. And, the
power became larger with larger sample sizes.</p>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<p><strong>Problem.</strong></p>
<ul>
<li>If we obtain the powers for two methods under a particular
simulation setting with 10,000 experiments: say, <span class="math inline">\(p_1=0.651\)</span> for one method and <span class="math inline">\(p_2=0.676\)</span> for another method. Can we say
the powers are different at 0.05 level?</li>
</ul>
<p><strong>Solution.</strong></p>
<ul>
<li>What is the corresponding hypothesis test problem?</li>
</ul>
<p><span class="math display">\[H_0:p_1=p_2\leftrightarrow
H_1:p_1\not=p_2.\]</span> - Which test can we use? Z-test, two-sample
t-test, paired-t test or McNemar test? Why?</p>
<p>Since the analysis results of the two methods for the same sample are
not independent, we cannot apply the Z-test and two-sample t-test.
Paired-t-test and McNemar test are designed to solve this problem, we
can use them of course(our sample size n=10000, is very large, and
according to the central limit theorem, samples can be regarded as
approximately following the normal distribution, so the paired-t-test
can be used).</p>
<ul>
<li>Please provide the least necessary information for hypothesis
testing.</li>
</ul>
<p>In order to apply the two methods selected in the previous question,
we need to obtain the results(rejected or not) of each sample under the
two methods.</p>
<p>Finally, we can answer the questions raised at the beginning.</p>
<p>#HW5</p>
</div>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 7.4 (Page 212, Statistical Computing with R).</p></li>
<li><p>Exercises 7.5 (Page 212, Statistical Computing with R).</p></li>
<li><p>Exercises 7.A (Page 213, Statistical Computing with R).</p></li>
</ol>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="exercise-7.4" class="section level3">
<h3>Exercise 7.4</h3>
<p><strong>Problem.</strong></p>
<p>Data set <strong>aircondit</strong> provided in the
<strong>boot</strong> package has 12 observations, which are the times
in hours between failures of air-conditioning equipment. Assume that the
times follow an exponential model Exp(λ). Obtain the
<strong>MLE</strong> of the hazard rate <span class="math inline">\(\lambda\)</span> and use bootstrap to estimate the
bias and standard error of the estimate.</p>
<p><strong>Solution.</strong></p>
<p>First, we obtain the MLE of <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math inline">\(X\sim Exp(\lambda)\)</span> has the
density <span class="math display">\[f(x)=\lambda e^{-\lambda x},\quad
x&gt;0,\lambda&gt;0.\]</span> Sample <span class="math inline">\(X_1,\dots,X_n\)</span>, the likelihood function
is<span class="math display">\[L(\lambda)=L(X_1,\dots,X_n;\lambda)=\prod
\limits_{i=1}^n f(X_i;\lambda)=\lambda^n e^{-\lambda
\sum_{i=1}^{n}X_i},\]</span>so,<span class="math display">\[l(\lambda)=\ln L(\lambda)=n\ln \lambda-\lambda
\sum\limits_{i=1}^n X_i;\]</span><span class="math display">\[\frac{\partial
l(\lambda)}{\partial\lambda}=\frac{n}{\lambda}-\sum\limits_{i=1}^n
X_i.\]</span>Let<span class="math inline">\(\frac{\partial
l(\lambda)}{\partial\lambda}=0,\)</span>we have MLE of <span class="math inline">\(\lambda\)</span>:<span class="math display">\[\hat\lambda=\frac{n}{\sum\limits_{i=1}^n
X_i}=\frac{1}{\bar X}.\]</span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20221020</span>)  <span class="co">#choose a seed for my homework</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span>aircondit[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,]  <span class="co">#our data</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>lambda_mle<span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(data)  <span class="co">#MLE of lambda</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The MLE of the hazard rate lambda is &quot;</span>,<span class="fu">round</span>(lambda_mle,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## The MLE of the hazard rate lambda is  0.0093</code></pre>
<p>Then we use bootstrap to estimate the bias and standard error of the
estimate.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co">#times for bootstrap</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>lambdastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="do">##bootstrap</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  datastar <span class="ot">&lt;-</span> <span class="fu">sample</span>(data,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  lambdastar[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(datastar)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="do">##result</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">lambdastarhat=</span><span class="fu">mean</span>(lambdastar),</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">bias=</span><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambda_mle,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">se.boot=</span><span class="fu">sd</span>(lambdastar)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## lambdastarhat          bias       se.boot 
##        0.0107        0.0014        0.0046</code></pre>
</div>
<div id="exercise-7.5" class="section level3">
<h3>Exercise 7.5</h3>
<p><strong>Problem.</strong></p>
<p>Compute 95% bootstrap confidence intervals for the mean time between
failures <span class="math inline">\(1/\lambda\)</span> by the standard
normal, basic, percentile, and BCa methods. Compare the intervals and
explain why they may differ.</p>
<p><strong>Solution.</strong></p>
<p>We modified the code of the courseware to calculate the mean time
<span class="math inline">\(1/\lambda\)</span>, whose estimation is
<span class="math inline">\(\bar X\)</span></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20221020</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="do">##bootstrap CI of 1/lambda</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span>ci.bca<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, <span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>ci.perc<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci.bca<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>res<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(ci.norm,ci.basic,ci.perc,ci.bca),<span class="at">ncol =</span> <span class="dv">2</span>,<span class="at">byrow =</span> T)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;2.5%&quot;</span>,<span class="st">&quot;97.5%&quot;</span>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(res)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;percentile&quot;</span>,<span class="st">&quot;BCa&quot;</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>##                2.5%    97.5%
## normal     33.53374 181.5917
## basic      24.83333 169.4167
## percentile 46.75000 191.3333
## BCa        57.19156 226.9424</code></pre>
<p>We found the intervals were different. The results of the four
methods are different because their ideas are different.</p>
<ul>
<li><strong>The Standard Normal Bootstrap Confidence
Interval</strong></li>
</ul>
<p>Based on the Central Limit Theorem, “normal” assumes that the mean
value estimate is unbiased (in fact, the bootstrap is biased, but for
this data, the bias 0.5206 is very small from the mean 108.08, so it is
not a problem) and the sample size is large(for this data, the size is
12, a little small), so as to approximate the normal, and obtain a
symmetric confidence interval on the mean value:<span class="math display">\[[\hat\theta-z_{1-\alpha/2}\hat
{se}(\hat\theta),\hat\theta-z_{\alpha/2}\hat
{se}(\hat\theta)]\]</span>However, the true distribution is not
necessarily symmetric. We can see from the following two figures that
the distribution of our data tends to be small, so the confidence
interval estimated by this method is a little bit to the left.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Sample histogram</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data,<span class="at">breaks =</span> <span class="dv">10</span>,<span class="at">main =</span> <span class="st">&quot;sample histogram&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">##1000 bootstrap histogram with mean, quantile 2.5% and 97.5% in EX7.4</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="dv">1</span><span class="sc">/</span>lambdastar,<span class="at">main =</span> <span class="st">&quot;bootstrap histogram&quot;</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span>lambdastar),<span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">quantile</span>(<span class="dv">1</span><span class="sc">/</span>lambdastar,<span class="fl">0.025</span>),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">quantile</span>(<span class="dv">1</span><span class="sc">/</span>lambdastar,<span class="fl">0.975</span>),<span class="at">col=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li><strong>The Other Three Methods</strong></li>
</ul>
<p>The above picture shows the confidence interval we obtained by
<strong>“percentile”</strong>method:<span class="math display">\[[\hat\theta_{\alpha/2}^*,\hat\theta_{1-\alpha/2}^*],\]</span>which
is based on the empirical distribution of the bootstrap replicates. It
has good theoretical properties and coverage performance. In fact, these
three methods are all based on the quantile of bootstrap replicates.
<strong>“Basic”</strong> corrects the bias according to the sample and
obtained a confidence interval equal to the length of “percentile”
method:<span class="math display">\[[2\hat\theta-\hat\theta_{1-\alpha/2}^*,2\hat\theta-\hat\theta_{\alpha/2}^*]\]</span>Under
our sample, the interval of “basic” is shifted to the left (because the
sample mean is in the left half of the confidence interval estimated by
“percentile”). Also, <strong>“BCa”</strong> improves the “percentile”
method through a correction for bias and a correction for skewness to
obtain a more accurate estimate:<span class="math display">\[[\hat\theta_{\alpha_1}^*,\hat\theta_{\alpha_2}^*],\]</span>where<span class="math display">\[\alpha_1=\Phi(\hat z_0+\frac{\hat
z_0+z_{\alpha/2}}{1-\hat a(\hat z_0+z_{\alpha/2})}),\alpha_2=\Phi(\hat
z_0+\frac{\hat z_0+z_{1-\alpha/2}}{1-\hat a(\hat
z_0+z_{1-\alpha/2})}),\]</span><span class="math display">\[\hat
z_0=\Phi^{-1}(\frac{1}{B}\sum_{b=1}^{B}I(\hat\theta^{(b)}&lt;\hat\theta)),\hat
a=\frac{\sum_{i=1}^{n}(\bar\theta_{(\cdot)}-\theta_i)^3}{6\sum_{i=1}^{n}((\bar\theta_{(\cdot)}-\theta_i)^2)^{3/2}}.\]</span>It
moves the confidence interval to the right when controlling the second
order accuracy.</p>
</div>
<div id="exercise-7.a" class="section level3">
<h3>Exercise 7.A</h3>
<p><strong>Problem.</strong></p>
<p>Conduct a Monte Carlo study to estimate the <strong>coverage
probabilities</strong> of the <em>standard normal bootstrap confidence
interval, the basic bootstrap confidence interval, and the percentile
confidence interval</em>. Sample from a <strong>normal
population</strong> and check the empirical coverage rates for the
sample mean. Find the proportion of times that the confidence intervals
miss on the left, and the porportion of times that the confidence
intervals miss on the right.</p>
<p><strong>Solution.</strong></p>
<p>We’re going to take samples of sample size <span class="math inline">\(n=10\)</span> from <span class="math inline">\(N(1,1)\)</span>. Here, our understanding of the
problem is: we test whether the population mean is covered by bootstrap
CI(if we test the sample mean coverage, the coverage is 1, because the
confidence intervals are designed according to the sample). We think of
“the confidence intervals miss on the left” as the confidence interval
occurring to the left of the mean.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="dv">1</span>;sigma<span class="ot">&lt;-</span><span class="dv">1</span>;n<span class="ot">&lt;-</span><span class="dv">10</span>;<span class="fu">set.seed</span>(<span class="dv">20221020</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="do">##Repeat 100 times to calculate the coverage of the three methods</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  dataA<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,mu,sigma)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(dataA,<span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="do">##result</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Empirical coverage rates: norm =&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;basic =&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;perc =&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu))</span></code></pre></div>
<pre><code>## Empirical coverage rates: norm = 0.94 basic = 0.93 perc = 0.95</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Left miss: norm =&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu),</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;basic =&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu),<span class="st">&#39;perc=&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu))</span></code></pre></div>
<pre><code>## Left miss: norm = 0.02 basic = 0.02 perc= 0.01</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Right miss: norm =&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;basic =&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="st">&#39;perc=&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu))</span></code></pre></div>
<pre><code>## Right miss: norm = 0.04 basic = 0.05 perc= 0.04</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>In our simulations, the empirical coverage of all three methods is
close to 0.95.</p>
<p>#HW6</p>
</div>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 7.8 (Page 213, Statistical Computing with R).</p></li>
<li><p>Exercises 7.11 (Page 213, Statistical Computing with R).</p></li>
<li><p>Exercises 8.2 (Page 242, Statistical Computing with R).</p></li>
</ol>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="exercise-7.8" class="section level3">
<h3>Exercise 7.8</h3>
<p><strong>Problem.</strong></p>
<p>Let <span class="math inline">\(\hat\lambda_1&gt;\dots&gt;\hat\lambda_5\)</span>
is the eigenvalues of <span class="math inline">\(\hat\Sigma\)</span>,
where <span class="math inline">\(\hat\Sigma\)</span> is the MLE of
covariance matrix <span class="math inline">\(\Sigma\)</span> of data
<strong>scor</strong>. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat\theta\)</span>, where
<span class="math inline">\(\hat\theta=\frac{\hat\lambda_1}{\sum_{j=1}^5\hat\lambda_j}\)</span></p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap);<span class="fu">attach</span>(scor)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(scor)</span></code></pre></div>
<pre><code>##   mec vec alg ana sta
## 1  77  82  67  67  81
## 2  63  78  80  70  81
## 3  75  73  71  66  81
## 4  55  72  63  70  68
## 5  63  63  65  70  63
## 6  53  61  72  64  73</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(scor)</span></code></pre></div>
<pre><code>## [1] 88  5</code></pre>
<p>First, the sample size is 88, which can be considered to follow
approximately normal distribution. Take the one-dimensional case, MLE of
variance <span class="math inline">\(\sigma^2\)</span> of <span class="math inline">\(X_1,\dots,X_n\)</span> is <span class="math inline">\(\frac{1}{n}\sum_{i=1}^n(x_i-\bar x)^2\)</span>. In
the p-dimensional case, we have the same result, so we can get the MLE
of covariance matrix <span class="math inline">\(\Sigma\)</span> by
<span class="math inline">\(\frac{n-1}{n}cov(X)\)</span>, where
<strong>cov</strong> is the unbiased covariance function in R.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">##original</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">dim</span>(scor)[<span class="dv">1</span>]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>Sigma<span class="ot">&lt;-</span>(<span class="dv">1-1</span><span class="sc">/</span>n)<span class="sc">*</span><span class="fu">cov</span>(scor) <span class="co">#Sigma</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="fu">eigen</span>(Sigma)<span class="sc">$</span>values <span class="co">#eigenvalues</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda) <span class="co">#PV of first principal component</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="do">##jackknife</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  Sigma.jack<span class="ot">&lt;-</span><span class="fu">cov</span>(scor[<span class="sc">-</span>i,])  <span class="co">#Sigma</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  lambda.jack<span class="ot">&lt;-</span><span class="fu">eigen</span>(Sigma.jack)<span class="sc">$</span>values <span class="co">#eigenvalues</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  theta.jack[i]<span class="ot">&lt;-</span>lambda.jack[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.jack) <span class="co">#PV of first principal component</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="do">##results</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(scor)</span></code></pre></div>
</div>
<div id="exercise-7.11" class="section level3">
<h3>Exercise 7.11</h3>
<p><strong>Problem.</strong></p>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<p><strong>Solution.</strong></p>
<p>Modify the code in the textbook, add a new loop to achieve
leave-two-out cross validation. My algorithm is as follows:</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>For <span class="math inline">\(k = 1, \dots, n-1\)</span> and <span class="math inline">\(l=k+1,\dots,n\)</span>, let observation <span class="math inline">\((x_k, y_k),(x_l,y_l)\)</span> be the test points
and use the remaining observations to fit the model.</li>
</ol></li>
</ul>
<ol style="list-style-type: lower-alpha">
<li><p>Fit the model(s) using only the n − 2 observations in the
training set, <span class="math inline">\((x_i, y_i), i \neq
k,l\)</span>.</p></li>
<li><p>Compute the predicted response <span class="math inline">\(\hat
y_k,\hat y_l\)</span> for the test points.</p></li>
<li><p>Compute the mean square prediction error <span class="math inline">\(e_{k,l} = \frac{(y_k − \hat y_k)^2+(y_l − \hat
y_l)^2}{2}\)</span>.</p></li>
</ol>
<ul>
<li><ol start="2" style="list-style-type: decimal">
<li>Average the mean square prediction error <span class="math inline">\(e_{k,l}\)</span> in (c): <span class="math inline">\(\hat \sigma_\epsilon ^2 =
\frac{1}{m}\sum\limits_{1\le k&lt;l\le n}e_{k,l}\)</span>, where <span class="math inline">\(m=\frac{n(n-1)}{2}.\)</span></li>
</ol></li>
</ul>
<p>In addition, we stored <span class="math inline">\(e_{k,l}\)</span>
in an <span class="math inline">\(n\times n\)</span> matrix, assigned
only m values of interest, and the other values were zero.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG); <span class="fu">attach</span>(ironslag)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span>n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> n,<span class="at">ncol =</span> n)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="do">## fit models on leave-two-out samples</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (l <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(k,l)]</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span><span class="fu">c</span>(k,l)]</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Linear model</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(k,l)]</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>    e1[k,l] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[<span class="fu">c</span>(k,l)] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Quadratic model</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(k,l)] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(k,l)]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    e2[k,l] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[<span class="fu">c</span>(k,l)] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Exponential model</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(k,l)]</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>    e3[k,l] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[<span class="fu">c</span>(k,l)] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log-Log model</span></span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">log</span>(chemical[<span class="fu">c</span>(k,l)])</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>    e4[k,l] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[<span class="fu">c</span>(k,l)] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a><span class="do">##result</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(e1)<span class="sc">/</span>m,<span class="fu">sum</span>(e2)<span class="sc">/</span>m, <span class="fu">sum</span>(e3)<span class="sc">/</span>m,<span class="fu">sum</span>(e4)<span class="sc">/</span>m)</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>According to the prediction error criterion, the quadratic model
would be the best fit for the data. We got the same conclusion as
Example 7.18, and We gave the same analysis as in the example:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>L2<span class="ot">&lt;-</span><span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(L2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.4335 -2.7006 -0.2754  2.5446 12.2665 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   24.49262    9.14657   2.678   0.0100 **
## chemical      -1.39334    0.88852  -1.568   0.1232   
## I(chemical^2)  0.05452    0.02081   2.620   0.0116 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.098 on 50 degrees of freedom
## Multiple R-squared:  0.5931, Adjusted R-squared:  0.5768 
## F-statistic: 36.44 on 2 and 50 DF,  p-value: 1.728e-10</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow = c(2, 2)) #layout for graphs</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L2<span class="sc">$</span>fit, L2<span class="sc">$</span>res) <span class="co">#residuals vs fitted values</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>) <span class="co">#reference line</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(L2<span class="sc">$</span>res) <span class="co">#normal probability plot</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(L2<span class="sc">$</span>res) <span class="co">#reference line</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow = c(1, 1)) #restore display</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(ironslag)</span></code></pre></div>
</div>
<div id="exercise-8.2" class="section level3">
<h3>Exercise 8.2</h3>
<p><strong>Problem.</strong></p>
<p>Implement the bivariate Spearman rank correlation test for
independence as a permutation test. The Spearman rank correlation test
statistic can be obtained from function cor with method = “spearman”.
Compare the achieved significance level of the permutation test with the
p-value reported by cor.test on the same samples.</p>
<p><strong>Solution.</strong></p>
<p>We test the correlation between the credits(x) of a semester and the
GPA(y) of that semester. Use permutation method to implement the
bivariate Spearman rank correlation test for independence, rearrange x
each time, and calculate correlation coefficient with y by
<strong>cor</strong> with method = “spearman”.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22088</span>) <span class="co">#choose a seed for my homework</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="do">## data</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">31</span>,<span class="fl">20.5</span>,<span class="dv">21</span>,<span class="dv">35</span>,<span class="fl">15.5</span>,<span class="dv">12</span>,<span class="dv">8</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">3.69</span>,<span class="fl">3.83</span>,<span class="fl">3.72</span>,<span class="fl">3.18</span>,<span class="fl">3.64</span>,<span class="fl">3.38</span>,<span class="fl">3.24</span>,<span class="dv">3</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="do">## permutation</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>r0<span class="ot">=</span><span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">999</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>reps<span class="ot">=</span><span class="fu">numeric</span>(N)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">=</span><span class="fu">sample</span>(x)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  reps[i]<span class="ot">=</span><span class="fu">cor</span>(x1,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(r0,reps))<span class="sc">&gt;=</span><span class="fu">abs</span>(r0))</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="do">## result</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(p,<span class="fu">cor.test</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.0920 0.0962</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>It can be seen that our results are relatively close.</p>
<p>#HW7</p>
</div>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 9.4 (Page 277, Statistical Computing with R).</p></li>
<li><p>Exercises 9.7 (Page 278, Statistical Computing with R).</p></li>
</ol>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="exercise-9.4" class="section level3">
<h3>Exercise 9.4</h3>
<p><strong>Problem.</strong><br />
Implement a <strong>random walk Metropolis sampler</strong> for
generating the <strong>standard Laplace distribution</strong>, which has
density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|},x\in
\mathbb{R}\)</span>. For the <strong>increment, simulate from a normal
distribution</strong>. Compare the chains generated when different
variances are used for the proposal distribution. Also, compute the
<strong>acceptance rates</strong> of each chain. Use the
<strong>Gelman-Rubin method</strong> to monitor convergence of the
chain, and run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat
R&lt;1.2\)</span>.</p>
<p><strong>Solution.</strong></p>
<p>First, modify the code on page 294 of <em>Statistical Computing with
R</em>, complete the sampling and calculate the acceptance rates. It is
easy to find 0.025 and 0.975 quantiles from density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|},x\in \mathbb{R}\)</span>:
<span class="math inline">\(\log(0.05)\)</span> and <span class="math inline">\(-\log(0.05)\)</span>.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>) <span class="co">#choose a seed for my homework</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="do">## some functions</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>laplace<span class="ot">&lt;-</span><span class="cf">function</span>(x){  <span class="co">#standard laplace density</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N) {  <span class="co">#random walk Metropolis sampler</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># increment simulated from a normal distribution</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">laplace</span>(y)<span class="sc">/</span><span class="fu">laplace</span>(x[i<span class="dv">-1</span>]))){</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span>  <span class="co">#accept</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Implement</span></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">16</span>) <span class="co">#different variances</span></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">25</span> <span class="co">#start</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k)<span class="sc">/</span>(N<span class="dv">-1</span>)) <span class="co">#rate of candidate points accepted</span></span></code></pre></div>
<pre><code>## [1] 0.9824912 0.8299150 0.5207604 0.1080540</code></pre>
<p>Based on these acceptance rates and the criteria proposed by A.
Gelman et al., sigma=2 is a better choice.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2)) #display 4 graphs together</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>refline <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="fl">0.05</span>),<span class="sc">-</span><span class="fu">log</span>(<span class="fl">0.05</span>)) <span class="co">#quantiles</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x, rw4<span class="sc">$</span>x)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rw[,j],<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylim=</span><span class="fu">range</span>(rw[,j]))</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span>refline)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb////tmb/25D//7b//9v///+xug5DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIGElEQVR4nO2dC5ujJhSGme0k20vSdjuZtN10c/H//8gaFVFRP9ADYvzePs9MTfDAvAVEPElVRkZRSzcgdSgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEEBYkFoNSwmSDRcOCgJQEGBhQel7WlaQ+xS4GJEFdS4OFITCURAIR0EgHAWBcOlPQosLSt3Q8oISN7T0SpqCUDgKAuEoCIWjIBCOgkC41hhLz1ZQQbf9h0M41TjciKD70dy1f/mOwhlBqvgnLcL0oKs6PH/59CCl90J86olAoCF2P77/cBakNigoy85vnz6C9A+V2iALN0lf1MFNkO45RedJrg8FvIrd9j/5CCrFbElQ9jgpb0HJ3b4uu2lfv5q1BKWkKJCgS/5HFr3ngtdB1WK6ubZ+eUGX/BJ2P+4yR0HZ1gQ9TofiZ74WchPUfuX1Bd2P5eR8fv/hLqjx3ssLKntQznk3SVBKigLNQZWW/K6Vgnq5VCugx2mCoKSWi8tvmPW+S0EgXDq3rBQESFSQfIVToSDACgRV2yCy9TuTuiBV3ahR0EAJZXarZRvgSuKCpnwmQJbUBWlFi01CKQtSRpCeheJbWoOg5oMh2VY4kMSe9GDZcoJuTkcirfAh3R6kBTWPFzCUtiBlC4ptKGVBWa+gyIZmCPqnfytMrN7upKyvZjNqnYCnoPs3fXzbD+wVStbbeb5ovxQeX0HHt8/iX85Dm82i9dpPz6IvhXyH2OOkds/u8/wZvt6+UpG7kP8cdFVvf6qqH0Wo1z6zfog/swmO1fkXLDtRrHrtM02Ww+xWuFTnXfDy7EHzJiCfeu0ztaE4V3xfQffjs/vkPw+R6u07t771iDDMAl3F/NJfPKly9eI8PQuzDvJNf/FE6Zv8RtqV3pyVJshKelL6iwdmB6SduBdiyAW5F5uZ/oLbUokxG41603Elgmamvzg0xuwvtgQFmJTC3M3PS39xaIzpK0ZQmHv9QNsdM9NfYGPM6foGrT1ny5HwftDY2U1BKtOCsgAPPxLek3ZrTXX50k+JzPNGIYINsYALxXagpqBMT9ypCwq8UGxHauvQCySx8OIFs/ALxW6otiDZyXqVC8VuKFuQ3Bhb50KxE8t++CG3F7LOhWInlv3ZoXrunh9cvGBB4IViJ9aAIJFOtM6FYieWsg/FZuqXENR/LGPoFQQNVSFi6JUFiVRDQQ5RZAsuEi5cNRQkFWGlgmbX8+KC5tezaUEujdiyIKfxR0EzAkwruEi4KfW4rbNXumnvUeN4W3rPaG0vza9oEmkKUtXrTuc7VzSJFATZg0wLUp2X5lU0iXiCBmpSDUGqVXbjgoyM8mZWmTGltCD70bZLRfPaGTjcWE2tSbedUFRnhTTfU9nWBCl3QZWcxikbFlS/W39DYd3dNiWolZ1XX9obHUk1HhIZQfVc5VyNaKNjCsrMMFKWoPoNkztbvaoNOtci2eS4gsySx/SWxhiqzWUtMdsSZP7+aq7pKdD8bVoYSNDjVPbmwVzq+ILM5btHUPdSnwUWdNGfVLgOfWQhuqBynOkjW1BdsvNKEEF1dkeu6vm90jPDCaE6EzMsXv5yDu/RFJ0flHONkLzgSEKC0uxBzUu7e+lQc1DVhRKZgzqV+mzXBbqK6f8vwkD/WUhQXfnygmKHC1d5ZEHx96TnEkhQvETy0ASapCMmkgcm4GU+ViJ5WIIuFMcSyVdDCEEOieR+QR3LLVJsUnGcSO4X9OUE4URyv6CvJ0g4KAXJlKOgFItNLC4blIJkylFQisUmFt8eFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCCAv6KrGvpa6TH/YNcuNnzDG7efv0iEtxAVd85Zdh1t3+/rZKQdOGOF+LB4dSIa0kRZUPjs7D351t05Nq8uhE4a5VsmkgiF7kBZ02z8fDA0/V7zsOuXQCYNc1aFUIxeyD3FBRX8fSmHM/7v+ks8Xh0Y5dMIY5VmiIS2kBZVDf3ACuB+fyWnngykHThiv7OlANqRFZEFVoS/f5QTJhrSIPcTKQvsPwSEmGtIi9iRdFvr6KTKjNgUJhbSIfJkv257/YSLX5EKQbEiL2AvFotn5jCqyqquuYpIhLeRvNS7jy/yz0nmguhw4YYRqiEmGtODNKoCCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEWIGgVk6vPjC5v4FJX1ArVaM+qHN/Q5O8oFayjzkQyh/DJC+olS5mDi4RRldBKoIef++LL4ayvsCylXBoDnTub3BSEXR+/ze7fev5/spWymp9UOf+BicRQVXX+K08OlffM1Z8QKVXUFkuxkSUiKDyT73/bl+aBoZY+d7+wyovTVqCjvYfPDBJl+9FuNYnIqhUo3tEc4j1X+br3N/gLUtEUD6v/FV+hWXPO30LxTr3NzSpCMr++0OpX3u/hbnK6X2cdlkjwbfO/Q1MMoJShYIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAvwPZmH0axfRpyoAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb////tmb/25D//7b//9v///8ZM4qDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHtUlEQVR4nO2diXbbNhQFkcROF7tNmlhto8aW+f8/WW4CAW7DBSBB6c7x0dECPJAjEICkR9pkYhSz9wakjgQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBcwRdnp/y21djzMcfsbYnOWYLOn/6Wdz7Fm2LEmOuoFpNqekumCvo7bEU9DpwkJnDEEsQ9KDDjPmRBBXqH7LrcL0y3K5EEZSVjj685BPZgB8JmhgufU8bC2qNfdOHwN2IJOicK6gG6aFZbEnUPYgj6JyPP5fnYpSWoD7evz+Vt/kUL0F9XD9gnD79lKA+qh6Uc3ogQckbijQG1Vry1dC4oPS7ULRZrDrI3r9L0Lp2JQjCSRCEkyAIJ0EQToIgnARBOAmCcBIE4SSoFaX9Y4EEQTgJgnASBOGS/75DggAJAiQI2FtQ8qO0BAESBERLf4EUPAmCFDwJmppAdbeCKAVvSdw92L0H5feSdhRJ0IwUPJP2YjHWND89Be9OBU0PZ7JZ2bZbs/c3ihKE4SQIwt2joGoWq6B1UKEnS9hQnB40mBbUE+4uBeWGHiaHK93cm6B8BTR+ophp3703QTPCSdCkcBIE4SQIwt2goH/WnNHcDZeooZmCLl+vj98eV53yfbOCnj+8lHdOK0+Jv1VB+Qqw+CLs7dHAQnB+uzciqFgCfvhi6n4Ust2bEVR3ouDtJvphY76gc9GDlg5AI+frJ/p5da6gy3PRffLboS+bF7d7G4JizmK3ISjeOijRYTqdlfTtCQrergRBuCQHIQkCJAiQIECCgJQEJTmNSRAgQYAEAZGSF6bnSS9uZCPiCZqYJ724kY2IJmjRhSYTnOijCerPk4YrgN6TIPWgERZfqpQERfe34seWmdu28FKlZrRM/A5mOq0mtQ5KQFBneJSgVgulIKedhAV1p7rogkxCgg7DXoL46e7GNc9E6krXhGTvTInJdQNvCj7dPZFsK0HmiIKqN3adIDheTCmoNZOlJsi4d/sEmW716fswWNLYBo3TyrzgUwuuCud0kdaa7XrCQleQadkyQy91BPkabMcx7jl+yQqys62xTzh9yD3Uqv1yKppuOCeo9y64BW1F43bf5AQZ586YIOe2Glevfcu4Mbw+UofIrKZhQVmqgjIQ1Cx1HTWuIDMqKGuG4NZQ7E0B3oas3aOFTBZ03WN3v+qZuLWg8wS1HLSr2Dhuay1BPdPBkj1ayPB8Yj3Yw8Jd1I4Jqpd41x7VCDItQU3NplG/R+0myLQ3ra9E1ky5zq7YF3rkmMaL0zkaQb6zPkGdz/Gp96DMrkncfW+mrdaOuosAp4J33DnOmsp2a44nKOsIyrwXmr9m9J0gqG6kjtU89BY/tsghBFXPttY0/s55hW0Pse04gjNbKXNfdiP6RZITlNmjKXOX063Nbx44d8YEZcOCjPuedBpIT5AzGvjLGKhvJ2pH7tWxafn19PpjT7tI0oLG+tlAzaxHkDt6tWrXg9eyDV1YcH24KYK4AdMSNLAZBxW0vlHnML1BQSEasILGwvFFH3YTdBhiCFqcHxQQ92PqWKnremCwxOQGpxbMVuQHBaTxAkfzXoJ2/0e0qQuaeh3F+Kzb/9vtQYGIJKgY/PSvjMcYyA+aP3vuTYoLxaSIKcj+s8y+cIdhJ0Hzgk4st0uxhcULJAiQIECCViNBgYJKUJhyEpRisYXFwwa9W0G3hAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBQHhBr2bsstTNr7O23HiFMd5++RE6ZIfggl6LX16Ht+7t80urHFQY4fJcplCEDNkltKDqG/3T4KW7r2khthxVGOa1TuQKGLKH0IKq9JjzYAra+aFVjioM8mqeKjXhQvYRXFDZ34fSh/L39dd8vHhyylGFMapaQUN2CC2oOvQHB4DLc5FYdHpqykGF8cYKB2FDdthYUF3o449wgsKG7LD1IVYVevwW8BALGrLD1oN0VejzS5AR1RUUKGSHjaf5atvzHQsyJ5eCwobssPVCsdzsfEQNsqqrZ7GQITuE/6hxNqPL/FM+J3/zykGFEepDLGTIDvqwCkgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEHAUQS5ib1N3u8GHESQl69h83634BiC/IyfQLlj0ziGID9n7LzR0VWSlKD3vx/Lq0N1ri7jZx1e8343ISlBp0//Zm9fey5A6OWt2rzfTUhJUN1Pfi8fnOprjZWHU09i71YDUUqCqn2+/NGdo3oSe+tLgkYnQUE9F9LtSezdaq5PSVClpu4a3iHmTfM273eTjUpJUD7I/JW76LtMrLdQtHm/W5CUoOy/P435rfcyunVi7/v3Us4173cD0hKUIBIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQcD/nZhwFA3jnAIAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(1,1))</span></span></code></pre></div>
<p>Then, we use the <strong>Gelman-Rubin method</strong> to monitor
convergence of the chain with sigma=2, and run the chain until it
converges approximately to the target distribution according to <span class="math inline">\(\hat R&lt;1.2\)</span>.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gelman-Rubin method function</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#length of chains</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma, x0[i], n)<span class="sc">$</span>x</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)){</span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As we can see, it converges quickly(n less than 2000 after discarding
a burn-in sample).</p>
</div>
<div id="exercise-9.7" class="section level3">
<h3>Exercise 9.7</h3>
<p><strong>Problem.</strong></p>
<p>Implement a <strong>Gibbs sampler</strong> to generate a bivariate
normal chain <span class="math inline">\((X_t, Y_t)\)</span> with
<strong>zero means, unit standard deviations, and correlation
0.9</strong>. Plot the generated sample after discarding a suitable
burn-in sample. Fit a simple linear regression model <span class="math inline">\(Y=β_0+β_1 X\)</span> to the sample and check the
residuals of the model for normality and constant variance. Use the
<strong>Gelman-Rubin</strong> method to monitor convergence of the
chain, and run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat
R&lt;1.2\)</span>.</p>
<p><strong>Solution.</strong></p>
<p>First, modify the code on page 268-269 of <em>Statistical Computing
with R</em>, generate a bivariate normal chain, plot and fit a linear
model. We use <strong>ks.test()</strong> for normality and
<strong>ncvTest()</strong> for constant variance(we also use
plot()).</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(carData)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     vif</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     logit</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Gibbs sampler function</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>bivariate.normal.chain<span class="ot">&lt;-</span><span class="cf">function</span>(mu,sigma,rho,N,<span class="at">initialize=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)){</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma[<span class="dv">1</span>]</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma[<span class="dv">2</span>]</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">###### generate the chain #####</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  Z[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> initialize <span class="co">#initialize</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> Z[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu[<span class="dv">1</span>] <span class="sc">+</span> rho <span class="sc">*</span> (y <span class="sc">-</span> mu[<span class="dv">2</span>]) <span class="sc">*</span> sigma[<span class="dv">1</span>]<span class="sc">/</span>sigma[<span class="dv">2</span>]</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    Z[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> Z[i, <span class="dv">1</span>]</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu[<span class="dv">2</span>] <span class="sc">+</span> rho <span class="sc">*</span> (x <span class="sc">-</span> mu[<span class="dv">1</span>]) <span class="sc">*</span> sigma[<span class="dv">2</span>]<span class="sc">/</span>sigma[<span class="dv">1</span>]</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>    Z[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Z)</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="co">#correlation</span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="co">#mean</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="co">#unit standard deviations</span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">bivariate.normal.chain</span>(mu,sigma,rho,N)</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> Z[b<span class="sc">:</span>N, ]</span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(Z[<span class="dv">1</span>]),<span class="at">ylab=</span><span class="fu">bquote</span>(Z[<span class="dv">2</span>]), <span class="at">ylim=</span><span class="fu">range</span>(z[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmAGZmOjpmtrZmtv+QOgCQOjqQOmaQZgCQ2/+2ZgC2tma2/7a2///bkDrb////tmb/25D//7b//9v////DkaI1AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIiklEQVR4nO2dDXubNhRGlS7pVq9bsy1e6zqO/v+/rAFJgA289wqBhHnP0yd1WiFdn1x9gMAxlkxicgdQOhQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCJBYkNkMuQSlrW45KGgMlzsUdE+txrgYKegO0/lDQQM4Nexid/gZqzdz7VbQ/fxtBqPaq6ABGxR0074Pwdy9uCkorjEluQXZsEgeTpy2nLjCuREtWl1cBMaf8rR/DxUT15eSnIKMX+CYjqLmy0Bhca3pAlygOmXTjSG/HHR6KOjmJMI2Zuz0mfuuBPXXyE3/alLIjdf7ziA/GLffW2O8Jf/y/ihx9WmiXKg6WYtuwnL9yo3Pnf/dqyA3a/lhuFFj+wOPFxcf6HYFhZGnZ6Xzoik1cnV1J4L8WNybswZyaEagmxTkO5dfDrYvOq9MZ+E4I9AtCgpLQj9ldQeeThcbn+QXE3S6Nv2tfvHpR4LqIukNMIOMn4OpA1W9o9PTm70cXmxmQSE73LzeH5vdpDaSOepANe/o4/VL/fX5Z25B1t6MNoPjM6hC3JaYy6HuXvb4/PNGkCKy2dz3pLvXgjgWzKArx5d8GTSRNhpDC41BTsvlYAoW5Ke26WrE7amiOzVz2DWX8o1BJWfQ6tUNtYATyGI/DyooTOswd3aXQS41FEM0iOSxBIWBV6ImXJNOE+gWBInE9NNnP12svaIh71qS5eqjCFKmDu5a6kBLF2SFQ48Rzl7qQEsXZMR+dOeBDyJI3cHSB1qyIEXyqJNo24L8TK3Vo0iiTQtyuaDWo0mhbQuKkjO6BTYv0CIFxbixOkObFhQ1OstOwfSBFiio7TBCN2EjaA+C1Hnjh3N3dPJACxOk8+MtRbQbI+j9s3mx9vJ1+Gpz4naHjtWcePWyaB1BH6/f7PnTj2yCdNc12uyR7GHMCLQtWJu5fP0+JejjtYlrZE9jpqCY1WFc/sRl0D9v16+Xv/4YF3Qybufw7F9EtxsOMJ2Xaju+W+qJG4OqTa/zaHa0O6tXVc8/57XblveHxJx7KU/hYwI19vLnm/9mQk6F35u/L9n9oaroCYphDUGHavKqAYIWyKCZXUz/E1EHWgn6+/DUJBEQFHaeE45BzVHucmmEolhUgr750RcJqrKtZiR/IgXFmJllRxNoI+g6QFduoKB07XaPiXITN7vrAzV+6D1ekyiDIBM1edkMgqok+n91QZHXxupDV+1iNcfxFXLydkP5CD1JrqlEFXyfWEUnbjccEJtAawWa/3LH+nJUgeYThG4Gv3ezL0G9ty1xk9TPFgTpTk/9UaniLV6QvGe1KTR78RMVaJr2tNUpl4dezZ4EafPHpdBOuph62yvtCC0PNIugflrg5EncueSB6gomq05/dmojdy5mBqosmKQ63b6F3zdNG6Io0IiCKaozmtN32x2ck/MAgsLz3mkjFAUaU3BOdb2FsLyHJZ+6YKBzCtbEPfXcHUfEepZzMx7orIIVkU89dze/FD1smdF5KtBZBe2Mp57bZBAISn7apQh0TkE79dSzsDrREsir2WAXm/vUcxmdSxBoVMGKWU89G/xkk+9dy/tZbhYbfuq5+9Mfb0iSO2tR1jrI/Y+ZGINm3IcQxZKCOjd5aKrzZ+bDetYYd3rRJC/YEiEoDL1FdK+JQGcUbNELanvRhJ4dZ1BnmDG3svzaaN+Chp4u6H5n1x6iS5vFhlLIduysnT62HEHhorKfqfw3TlCY/temEEHhmo4JNzSH8cZfC1t//BkINEHBqOpM/0/rqHtGsVtB7UATJPT/sp0cWpsCBLVJ0z4vcCMoS+6E6BIXVFfXpknnn/u9a9+ChseY/jZFjs7l40hdcEZ1N0ryWelQlKB+iTR3qc6lXEFlJFBeQWUomCanoIxzkxwKArCLARYV1DzciqorW9MigvzjdBVwX6zwjrZMBrknMUUZtEtB1xyqHsZkF5vg+PQmFFQ2yw3SJ/OFgiZ5//zbnaBc23/xLDnNf7ya8QzaDIsKitqbf/iSAQoCUBCAggAUNIOtvBkKylAyW8NbKZmt4a2U3CkUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIkF7QcfSjgrvUn44/fmUycDbm6Q0Xk1fYIAuyIrmg8/hnKXf4eL2+7VP4pO/x2q7FzhJD0gpdtaIga1ILuhxEbTe712NP3weay99HwdsWVtggDLImtaDT83/itnFuqN62pMIGTZCJBb3//ibv3vaI3vm1Oqv5HHBYoa811xhUdQl526OfjN+WqDNCmBeSCit0QaYVVP2yBHHbZ9kYLRckqLBCFWRaQXWPkLYt+XGrupgsf3RBphNUfTbVl5O7tWT07phQsvNrcKbQDNKiCl37MMiWXAvFkyhA+TQvrNCTcaEoa/v9s+zHLV4oSit0FC/I5Tl+6yfhqYa4woacgh4MCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAUoW5D+vSLUlmJqSBTWcpJuBy1C8IOWecnJKF1T/LqqclC4ocwcrXlDuDla6oOwdrHRB2TtY4YKa36dYv/oqvRM4NUULCrc9Xw7iW6VTU7Kgs7/t8OPf78ygAY7uftQXdjEIBQEoCEBBAAoqFgoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCPALJMYRHaUy+7AAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Linear</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span>z[,<span class="dv">2</span>]</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span>z[,<span class="dv">1</span>]</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">lm</span>(Y<span class="sc">~</span>X)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>res<span class="ot">&lt;-</span>model<span class="sc">$</span>residuals</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co">#normality</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(res,<span class="st">&quot;pnorm&quot;</span>,<span class="at">mean=</span><span class="fu">mean</span>(res),<span class="at">sd=</span><span class="fu">sqrt</span>(<span class="fu">var</span>(res)))</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  res
## D = 0.01142, p-value = 0.6739
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#constant variance</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ncvTest</span>(model)</span></code></pre></div>
<pre><code>## Non-constant Variance Score Test 
## Variance formula: ~ fitted.values 
## Chisquare = 0.3100014, Df = 1, p = 0.57768</code></pre>
<p>P-value &gt; 0.05, the residuals of the model had normality and
constant variance.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(1,1))</span></span></code></pre></div>
<p>Then, we use the <strong>Gelman-Rubin method</strong> to monitor
convergence of the chain (X and Y separately according to the reference
109 of <em>Statistical Computing with R</em>).</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chains</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co">#burn-in length</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>initialize<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>  Z<span class="ot">&lt;-</span><span class="fu">bivariate.normal.chain</span>(mu,sigma,rho,n,<span class="at">initialize=</span>initialize[,k])</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> Z[,<span class="dv">2</span>]</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>  Y[i, ] <span class="ot">&lt;-</span> Z[,<span class="dv">1</span>]</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="do">## X</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>psiX <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psiX)){</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>  psiX[i,] <span class="ot">&lt;-</span> psiX[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psiX))</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psiX[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Y</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>psiY <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Y, <span class="dv">1</span>, cumsum))</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psiY)){</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  psiY[i,] <span class="ot">&lt;-</span> psiY[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psiY))</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psiY[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Y&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the memory</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>We can see that both x and y converge very quickly(After discarding a
burn-in sample, n less than 500 for x and less than 2500).</p>
<p>#HW8</p>
</div>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 1</p></li>
<li><p>Exercises 2</p></li>
</ol>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="exercise-1" class="section level3">
<h3>Exercise 1</h3>
<p><strong>problem</strong></p>
<p>permutation test for mediation effect in PPT</p>
<p><strong>Solution.</strong></p>
<p>We will simulate the permutation test in three parameter cases
respectively. The test statistic T of the mediation effect is:<span class="math display">\[T=\frac{\hat\alpha\hat\beta}{\widehat{se}(\hat\alpha\hat\beta)},\]</span>
which can be obtained by two linear models:<span class="math display">\[M=a_M+\hat\alpha X+e_M;\]</span><span class="math display">\[Y=a_Y+\hat\beta M+\hat\gamma
X+e_Y,\]</span>and<span class="math display">\[{\widehat{se}(\hat\alpha\hat\beta)}=\sqrt{\hat\alpha^2\times\widehat{var}(\hat\beta)+\hat\beta^2\times\widehat{var}(\hat\alpha)}.\]</span></p>
<p>Here, we set <span class="math inline">\(X\sim
Exp(1),a_M=a_Y=1.\)</span> In different parameter cases, in order to
control type-1 errors, we have different permutations:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="do">## functions for T-statistic</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>TS0<span class="ot">&lt;-</span><span class="cf">function</span>(x,m,y){</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  ml1<span class="ot">&lt;-</span><span class="fu">lm</span>(m<span class="sc">~</span>x)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  ml2<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>m<span class="sc">+</span>x)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  alpha_hat<span class="ot">&lt;-</span><span class="fu">summary</span>(ml1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  alpha_var<span class="ot">&lt;-</span>(<span class="fu">summary</span>(ml1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  beta_hat<span class="ot">&lt;-</span><span class="fu">summary</span>(ml2)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  beta_var<span class="ot">&lt;-</span>(<span class="fu">summary</span>(ml2)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  ab_var<span class="ot">&lt;-</span>(alpha_hat<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>beta_var<span class="sc">+</span>(beta_hat<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>alpha_var</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  ab_se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(ab_var)</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(alpha_hat<span class="sc">*</span>beta_hat<span class="sc">/</span>ab_se)</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>TS<span class="ot">&lt;-</span><span class="cf">function</span>(ml1,ml2){</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  alpha_hat<span class="ot">&lt;-</span><span class="fu">summary</span>(ml1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  alpha_var<span class="ot">&lt;-</span>(<span class="fu">summary</span>(ml1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>  beta_hat<span class="ot">&lt;-</span><span class="fu">summary</span>(ml2)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>  beta_var<span class="ot">&lt;-</span>(<span class="fu">summary</span>(ml2)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>  ab_var<span class="ot">&lt;-</span>(alpha_hat<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>beta_var<span class="sc">+</span>(beta_hat<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>alpha_var</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>  ab_se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(ab_var)</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(alpha_hat<span class="sc">*</span>beta_hat<span class="sc">/</span>ab_se)</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a><span class="do">## N:simulation numbers; n:sample size; R:permutation numbers</span></span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22088</span>) <span class="co">#choose a seed for my homework</span></span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">500</span>;n<span class="ot">&lt;-</span><span class="dv">20</span>;am<span class="ot">&lt;-</span><span class="dv">1</span>;ay<span class="ot">&lt;-</span><span class="dv">1</span>;gamma<span class="ot">&lt;-</span><span class="dv">1</span>;R<span class="ot">&lt;-</span><span class="dv">99</span>;res<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a><span class="do">##alpha=0,beta=0</span></span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="dv">0</span>;beta<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){  <span class="co">#simulation</span></span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n)</span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span>am<span class="sc">+</span>alpha<span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>ay<span class="sc">+</span>beta<span class="sc">*</span>m<span class="sc">+</span>gamma<span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>  T0<span class="ot">&lt;-</span><span class="fu">TS0</span>(x,m,y)</span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a>  reps<span class="ot">=</span><span class="fu">numeric</span>(R)</span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){  <span class="co">#permutation</span></span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>    m1<span class="ot">=</span><span class="fu">sample</span>(m)</span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a>    ml1<span class="ot">&lt;-</span><span class="fu">lm</span>(m1<span class="sc">~</span>x)</span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a>    ml2<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>m1<span class="sc">+</span>x)</span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a>    reps[j]<span class="ot">=</span><span class="fu">TS</span>(ml1,ml2)</span>
<span id="cb96-42"><a href="#cb96-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb96-43"><a href="#cb96-43" aria-hidden="true" tabindex="-1"></a>  p[i]<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,reps))<span class="sc">&gt;=</span><span class="fu">abs</span>(T0))</span>
<span id="cb96-44"><a href="#cb96-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-45"><a href="#cb96-45" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(p<span class="sc">&lt;</span><span class="fl">0.05</span>)  <span class="co">#Type-1 error</span></span>
<span id="cb96-46"><a href="#cb96-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-47"><a href="#cb96-47" aria-hidden="true" tabindex="-1"></a><span class="do">##alpha=0,beta=1</span></span>
<span id="cb96-48"><a href="#cb96-48" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="dv">0</span>;beta<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb96-49"><a href="#cb96-49" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb96-50"><a href="#cb96-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb96-51"><a href="#cb96-51" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n)</span>
<span id="cb96-52"><a href="#cb96-52" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span>am<span class="sc">+</span>alpha<span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb96-53"><a href="#cb96-53" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>ay<span class="sc">+</span>beta<span class="sc">*</span>m<span class="sc">+</span>gamma<span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb96-54"><a href="#cb96-54" aria-hidden="true" tabindex="-1"></a>  T0<span class="ot">&lt;-</span><span class="fu">TS0</span>(x,m,y)</span>
<span id="cb96-55"><a href="#cb96-55" aria-hidden="true" tabindex="-1"></a>  reps<span class="ot">=</span><span class="fu">numeric</span>(R)</span>
<span id="cb96-56"><a href="#cb96-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb96-57"><a href="#cb96-57" aria-hidden="true" tabindex="-1"></a>    m1<span class="ot">=</span><span class="fu">sample</span>(m)</span>
<span id="cb96-58"><a href="#cb96-58" aria-hidden="true" tabindex="-1"></a>    ml1<span class="ot">&lt;-</span><span class="fu">lm</span>(m1<span class="sc">~</span>x)</span>
<span id="cb96-59"><a href="#cb96-59" aria-hidden="true" tabindex="-1"></a>    ml2<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>m<span class="sc">+</span>x)</span>
<span id="cb96-60"><a href="#cb96-60" aria-hidden="true" tabindex="-1"></a>    reps[j]<span class="ot">=</span><span class="fu">TS</span>(ml1,ml2)</span>
<span id="cb96-61"><a href="#cb96-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb96-62"><a href="#cb96-62" aria-hidden="true" tabindex="-1"></a>  p[i]<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,reps))<span class="sc">&gt;=</span><span class="fu">abs</span>(T0))</span>
<span id="cb96-63"><a href="#cb96-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-64"><a href="#cb96-64" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(p<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb96-65"><a href="#cb96-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-66"><a href="#cb96-66" aria-hidden="true" tabindex="-1"></a><span class="do">##alpha=1,beta=0</span></span>
<span id="cb96-67"><a href="#cb96-67" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="dv">1</span>;beta<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb96-68"><a href="#cb96-68" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb96-69"><a href="#cb96-69" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb96-70"><a href="#cb96-70" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n)</span>
<span id="cb96-71"><a href="#cb96-71" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span>am<span class="sc">+</span>alpha<span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb96-72"><a href="#cb96-72" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>ay<span class="sc">+</span>beta<span class="sc">*</span>m<span class="sc">+</span>gamma<span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb96-73"><a href="#cb96-73" aria-hidden="true" tabindex="-1"></a>  T0<span class="ot">&lt;-</span><span class="fu">TS0</span>(x,m,y)</span>
<span id="cb96-74"><a href="#cb96-74" aria-hidden="true" tabindex="-1"></a>  reps<span class="ot">=</span><span class="fu">numeric</span>(R)</span>
<span id="cb96-75"><a href="#cb96-75" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb96-76"><a href="#cb96-76" aria-hidden="true" tabindex="-1"></a>    m1<span class="ot">=</span><span class="fu">sample</span>(m)</span>
<span id="cb96-77"><a href="#cb96-77" aria-hidden="true" tabindex="-1"></a>    ml1<span class="ot">&lt;-</span><span class="fu">lm</span>(m<span class="sc">~</span>x)</span>
<span id="cb96-78"><a href="#cb96-78" aria-hidden="true" tabindex="-1"></a>    ml2<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>m1<span class="sc">+</span>x)</span>
<span id="cb96-79"><a href="#cb96-79" aria-hidden="true" tabindex="-1"></a>    reps[j]<span class="ot">=</span><span class="fu">TS</span>(ml1,ml2)</span>
<span id="cb96-80"><a href="#cb96-80" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb96-81"><a href="#cb96-81" aria-hidden="true" tabindex="-1"></a>  p[i]<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,reps))<span class="sc">&gt;=</span><span class="fu">abs</span>(T0))</span>
<span id="cb96-82"><a href="#cb96-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-83"><a href="#cb96-83" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(p<span class="sc">&lt;</span><span class="fl">0.05</span>)</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="do">##result</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>res<span class="ot">&lt;-</span><span class="fu">matrix</span>(res,<span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;a=b=0&quot;</span>,<span class="st">&quot;a=0,b=1&quot;</span>,<span class="st">&quot;a=1,b=0&quot;</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(res)<span class="ot">&lt;-</span><span class="st">&quot;Type-1 error&quot;</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>##              a=b=0 a=0,b=1 a=1,b=0
## Type-1 error 0.042    0.04   0.028</code></pre>
<p>It can be seen that these three permutation tests can control the
type I error well.</p>
</div>
<div id="exercise-2" class="section level3">
<h3>Exercise 2</h3>
<p><strong>problem</strong></p>
<p>Also in PPT</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22088</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="do">## function</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">rpois</span>(N,<span class="at">lambda =</span> <span class="dv">1</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N,<span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  x3<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  g<span class="ot">&lt;-</span><span class="cf">function</span>(alpha){</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>    tmp<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    p<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(p)<span class="sc">-</span>f0</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>  solution<span class="ot">&lt;-</span><span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>  alpha0<span class="ot">&lt;-</span>solution<span class="sc">$</span>root</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(alpha0)</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="do">## use the function</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fl">1e6</span>;b1<span class="ot">&lt;-</span><span class="dv">0</span>;b2<span class="ot">&lt;-</span><span class="dv">1</span>;b3<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span>;f0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f0)) {</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>  alpha[i]<span class="ot">&lt;-</span><span class="fu">f</span>(N,b1,b2,b3,f0[i])</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a><span class="do">## plot</span></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(alpha,f0,<span class="at">main =</span> <span class="st">&quot;f0 vs. alpha&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="do">## clean the memory</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>#HW9</p>
</div>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Class Work</p></li>
<li><p>Home Work</p></li>
</ol>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="class-work" class="section level3">
<h3>Class Work</h3>
<p><strong>problem</strong></p>
<p>Likelihood vs EM in MLE.</p>
<p><strong>Solution.</strong></p>
<ul>
<li><strong>MLE of observed data</strong></li>
</ul>
<p>Observed data likelihood function: <span class="math display">\[L(\lambda|u_i,v_i)=\prod\limits_{i=1}^n
P_\lambda(u_i\leqslant x_i\leqslant v_i)=\prod\limits_{i=1}^n
(e^{-\lambda u_i}-e^{-\lambda v_i}).\]</span> Log-Likelihood function:
<span class="math display">\[l(\lambda)=\sum\limits_{i=1}^n
\log(e^{-\lambda u_i}-e^{-\lambda v_i}).\]</span> We can get the
MLE<span class="math inline">\(\hat\lambda\)</span> by solving<span class="math display">\[\frac{\partial l}{\partial
\lambda}=\sum\limits_{i=1}^n (\frac{-u_i e^{-\lambda u_i}+v_i
e^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}})=0.\tag{1}\]</span></p>
<ul>
<li><strong>EM Algorithm</strong></li>
</ul>
<p>Complete data likelihood function:<span class="math display">\[L(\lambda|u_i,x_i,v_i)=\prod\limits_{i=1}^n
P(X_i=x_i).\]</span> Log-Likelihood function:<span class="math display">\[l(\lambda|u_i,x_i,v_i)=n\log\lambda-\lambda\sum\limits_{i=1}^n
x_i.\]</span> <strong>E-step</strong>:<span class="math display">\[\begin{aligned}&amp;E_{\lambda_0}(l(\lambda|u_i,x_i,v_i)|u_i,v_i)\\=&amp;n\log\lambda-\lambda\sum\limits_{i=1}^nE_{\lambda_0}(x_i|u_i,v_i)\\=&amp;n\log\lambda-\lambda\sum\limits_{i=1}^n\frac{\int_{u_i}^{v_i}x_i\lambda_0e^{-\lambda_0x_i}dx_i}{\int_{u_i}^{v_i}\lambda_0e^{-\lambda_0x_i}dx_i}\\=&amp;n\lambda-\lambda\sum\limits_{i=1}^n\frac{(u_ie^{-\lambda_0u_i}-v_ie^{-\lambda_0v_i}+\frac{1}{\lambda_0}e^{-\lambda_0u_i}-\frac{1}{\lambda_0}e^{-\lambda_0v_i})}{e^{-\lambda_0u_i}-e^{-\lambda_0v_i}}.\end{aligned}\]</span></p>
<p><strong>M-step</strong></p>
<p>Solve<span class="math display">\[\frac{\partial
E_{\lambda_0}}{\partial\lambda}=0,\]</span> get<span class="math display">\[\begin{aligned}\lambda_1&amp;=\frac{n}{\sum\limits_{i=1}^n\frac{(u_ie^{-\lambda_0u_i}-v_ie^{-\lambda_0v_i}+\frac{1}{\lambda_0}e^{-\lambda_0u_i}-\frac{1}{\lambda_0}e^{-\lambda_0v_i})}{e^{-\lambda_0u_i}-e^{-\lambda_0v_i}}}\\&amp;=\frac{n}{\sum\limits_{i=1}^n
(\frac{u_ie^{-\lambda_0u_i}-v_ie^{-\lambda_0v_i}}{e^{-\lambda_0u_i}-e^{-\lambda_0v_i}}+\frac{1}{\lambda_0})}.
\end{aligned} \tag{2}\]</span> We can get the MLE <span class="math inline">\(\hat\lambda\)</span> by solving for the fixed
point of formula(2). We note that <strong>this result will be the same
as that given by formula (1)</strong>, because substituting formula (1)
into (2) gives us:<span class="math display">\[\lambda_1=\frac{n}{\sum\limits_{i=1}^n(0+\frac{1}{\lambda_0})}=\lambda_0,\]</span>which
means that the MLE of formula (1) is exactly the fixed point of formula
(2)!</p>
<p>Finally, we solve the convergence problem of EM algorithm, we
define<span class="math display">\[f(\lambda)=\frac{n}{\sum\limits_{i=1}^n
(\frac{u_ie^{-\lambda u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda
u_i}-e^{-\lambda v_i}}+\frac{1}{\lambda})},\]</span>then according to
the principle of contractive mapping, we only need to prove that the
absolute value of its derivative function is less than 1, that is<span class="math display">\[|f&#39;(\lambda)|=\left|\frac{-\frac{n^2}{\lambda^2}+n\sum\limits_{i=1}^n\frac{(v_i-u_i)^2e^{-\lambda
u_i-\lambda v_i}}{(e^{-\lambda u_i}-e^{-\lambda
v_i})^2}}{\left(\sum\limits_{i=1}^n (\frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}+\frac{1}{\lambda})\right)^2}\right|&lt;1.\]</span>The theoretical
proof is complicated, we can see its correctness through the following
numerical simulation:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>num<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22088</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(lambda <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)){</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1</span>)) {</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    u<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,lambda)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>    v<span class="ot">&lt;-</span>u<span class="sc">+</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>    molecules<span class="ot">&lt;-</span><span class="sc">-</span>(n<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(lambda<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span>n<span class="sc">*</span><span class="fu">sum</span>((v<span class="sc">-</span>u)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u<span class="sc">-</span>lambda<span class="sc">*</span>v)<span class="sc">/</span>((<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>    denominator<span class="ot">&lt;-</span>(<span class="fu">sum</span>((u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)<span class="sc">+</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">/</span>lambda)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(molecules<span class="sc">/</span>denominator)<span class="sc">&gt;=</span><span class="dv">1</span>){num<span class="ot">=</span>num<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>num</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>There is no case greater than or equal to 1. The first question has
been proved here, and then the numerical calculation in the second
question is carried out:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>v<span class="ot">&lt;-</span>u<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>mle<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol =</span> <span class="dv">2</span>,<span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Direct MLE</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>mlogL<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">lambda=</span><span class="dv">1</span>){</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sum</span>(<span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))))</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>mle[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">optimize</span>(mlogL,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))<span class="sc">$</span>minimum</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="do">## EM Algorithm</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>lambda0<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(u)</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>times<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">abs</span>(lambda<span class="sc">-</span>lambda0)<span class="sc">&gt;</span><span class="fl">0.0001</span>) {</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>  lambda0<span class="ot">&lt;-</span>lambda</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>  <span class="do">## M-step</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span>n<span class="sc">/</span><span class="fu">sum</span>((u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda0<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda0<span class="sc">*</span>v)<span class="sc">+</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda0<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda0<span class="sc">*</span>v))<span class="sc">/</span>lambda0)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda0<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda0<span class="sc">*</span>v)))</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>  times<span class="ot">&lt;-</span>times<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>mle[<span class="dv">2</span>]<span class="ot">&lt;-</span>lambda</span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a><span class="do">## result</span></span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mle)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;direct&quot;</span>,<span class="st">&quot;EM&quot;</span>)</span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mle)<span class="ot">&lt;-</span><span class="st">&quot;MLE&quot;</span></span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a>mle;times</span></code></pre></div>
<pre><code>##         direct        EM
## MLE 0.07197428 0.0719735</code></pre>
<pre><code>## [1] 3</code></pre>
<p>We can see that the numerical solutions of the two algorithms are
identical and it only needs three updates to converge.</p>
</div>
<div id="home-work" class="section level3">
<h3>Home Work</h3>
<p><strong>problems of 2.1.3</strong></p>
<ul>
<li>Exercise 4, 5 (Pages 19 Advanced in R)</li>
</ul>
<p><strong>Solutions of 2.1.3</strong></p>
<ul>
<li>Exercise 4</li>
</ul>
<p>To get rid of the nested structure. For ‘as.vector’, a vector (atomic
or of type list or expression). All attributes are removed from the
result if it is of an atomic mode, but not in general for a list or
expression result.</p>
<ul>
<li>Exercise 5</li>
</ul>
<p>For comparison operators “==” and “&lt;”, if the two arguments are
atomic vectors of different types, one is coerced to the type of the
other, the (decreasing) order of precedence being character, complex,
numeric, integer, logical and raw. And character strings can be compared
with different marked encodings: they are translated to UTF-8 before
comparison. So, the above three situations are: ‘1’==‘1’, -1&lt;0 and
‘one’&lt;‘2’. Because “one” comes after “2” in ASCII, so the results
are: True, True, False.</p>
<p><strong>problems of 2.3.1</strong></p>
<ul>
<li>Exercise 1, 2 (Pages 26 Advanced in R)</li>
</ul>
<p><strong>Solutions of 2.3.1</strong></p>
<ul>
<li>Exercise 1</li>
</ul>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(v)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<ul>
<li>Exercise 2</li>
</ul>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.array</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p><strong>problems of 2.4.5</strong></p>
<ul>
<li>Exercise 1, 2, 3 (Pages 30 Advanced in R)</li>
</ul>
<p><strong>Solutions of 2.4.5</strong></p>
<ul>
<li>Exercise 1</li>
</ul>
<p>names, row.names and class:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(df)</span></code></pre></div>
<pre><code>## $names
## [1] &quot;X1&quot; &quot;X2&quot;
## 
## $class
## [1] &quot;data.frame&quot;
## 
## $row.names
## [1] 1 2</code></pre>
<ul>
<li>Exercise 2</li>
</ul>
<p>‘as.matrix’ is a generic function. The method for data frames will
return a character matrix if there is only atomic columns and any
non-(numeric/logical/complex) column, applying ‘as.vector’ to factors
and ‘format’ to other non-character columns. Otherwise, the usual
coercion hierarchy (logical &lt; integer &lt; double &lt; complex) will
be used, e.g., all-logical data frames will be coerced to a logical
matrix, mixed logical-integer will give a integer matrix, etc.</p>
<ul>
<li>Exercise 3</li>
</ul>
<p>Yes, we can:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>row0<span class="ot">&lt;-</span>df[<span class="cn">NULL</span>,]</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>col0<span class="ot">&lt;-</span>df[,<span class="cn">FALSE</span>]</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(row0);<span class="fu">dim</span>(col0)</span></code></pre></div>
<pre><code>## [1] 0 2</code></pre>
<pre><code>## [1] 2 0</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="do">## clean the memory</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>#HW10</p>
</div>
</div>
<div id="question-10" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 2 (page 204, Advanced R)</p></li>
<li><p>Exercises 1 (page 213, Advanced R)</p></li>
<li><p>Rcpp Exercise</p></li>
</ol>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="exercises-2-page-204-advanced-r" class="section level3">
<h3>Exercises 2 (page 204, Advanced R)</h3>
<p><strong>problem</strong></p>
<p>in book</p>
<p><strong>Solution.</strong></p>
<p>First, we use ‘lapply()’ to apply ‘scale01’ to every column of a data
frame ‘cars’ in R.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>scale01<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  rng<span class="ot">&lt;-</span><span class="fu">range</span>(x,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  (x<span class="sc">-</span>rng[<span class="dv">1</span>])<span class="sc">/</span>(rng[<span class="dv">2</span>]<span class="sc">-</span>rng[<span class="dv">1</span>])</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>scale_cars<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">lapply</span>(cars, scale01))</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(scale_cars)</span></code></pre></div>
<pre><code>##       speed       dist
## 1 0.0000000 0.00000000
## 2 0.0000000 0.06779661
## 3 0.1428571 0.01694915
## 4 0.1428571 0.16949153
## 5 0.1904762 0.11864407
## 6 0.2380952 0.06779661</code></pre>
<p>However, there will be an error if the data frame has a non-numeric
column because ‘range()’ is not meaningful for factors. In order to
apply ‘scale01’ to every numeric column in a data frame, we use:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#new_scale01&lt;-function(x){</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  if(is.numeric(x)==T){</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co">#    scale01(x)</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  else{</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="co">#    x</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="co">#scale_iris&lt;-data.frame(lapply(iris, new_scale01))</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>scale_iris<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">lapply</span>(iris, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x))</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(scale_iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1   0.22222222   0.6250000   0.06779661  0.04166667  setosa
## 2   0.16666667   0.4166667   0.06779661  0.04166667  setosa
## 3   0.11111111   0.5000000   0.05084746  0.04166667  setosa
## 4   0.08333333   0.4583333   0.08474576  0.04166667  setosa
## 5   0.19444444   0.6666667   0.06779661  0.04166667  setosa
## 6   0.30555556   0.7916667   0.11864407  0.12500000  setosa</code></pre>
</div>
<div id="exercises-1-page-213-advanced-r" class="section level3">
<h3>Exercises 1 (page 213, Advanced R)</h3>
<p><strong>problem</strong></p>
<p>in book</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="do">## numeric data frame</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(cars,sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     speed      dist 
##  5.287644 25.769377</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="do">## mixed data frame</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="co">#index&lt;-vapply(iris, is.numeric, logical(1))</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="co">#vapply(iris[index],sd,numeric(1))</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(iris[<span class="fu">vapply</span>(iris, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))],sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
</div>
<div id="rcpp-exercise" class="section level3">
<h3>Rcpp Exercise</h3>
<p><strong>problem</strong></p>
<p>Gibbs in R and C</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StatComp22088)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Functions by R and C++</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="co">#cppFunction(&#39;NumericMatrix gibbsC(double mu1,double sigma1,double mu2,double sigma2,double rho,int N) {</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  NumericMatrix Z(N, 2);</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  double s1=0,s2=0;</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  s1 = sqrt(1-rho*rho)*sigma1;</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  s2 = sqrt(1-rho*rho)*sigma2;</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  Z(0,0) = 0;</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  Z(0,1) = 0;   </span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  double y = 0, m1 = 0, x=0, m2=0;</span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  for(int i = 1; i &lt; N; i++) {</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a><span class="co">#    y = Z(i-1, 1);</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    m1 = mu1 + rho * (y - mu2) * sigma1/sigma2;</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a><span class="co">#    Z(i, 0) = rnorm(1, m1, s1)[0];</span></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    x = Z(i, 0);</span></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a><span class="co">#    m2 = mu2 + rho * (x - mu1) * sigma2/sigma1;</span></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a><span class="co">#    Z(i, 1) = rnorm(1, m2, s2)[0];</span></span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a><span class="co">#  return(Z);</span></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a><span class="co">#}&#39;)</span></span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(mu,sigma,rho,N){</span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma[<span class="dv">1</span>]</span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma[<span class="dv">2</span>]</span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a>  Z[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> Z[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu[<span class="dv">1</span>] <span class="sc">+</span> rho <span class="sc">*</span> (y <span class="sc">-</span> mu[<span class="dv">2</span>]) <span class="sc">*</span> sigma[<span class="dv">1</span>]<span class="sc">/</span>sigma[<span class="dv">2</span>]</span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a>    Z[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb124-32"><a href="#cb124-32" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> Z[i, <span class="dv">1</span>]</span>
<span id="cb124-33"><a href="#cb124-33" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu[<span class="dv">2</span>] <span class="sc">+</span> rho <span class="sc">*</span> (x <span class="sc">-</span> mu[<span class="dv">1</span>]) <span class="sc">*</span> sigma[<span class="dv">2</span>]<span class="sc">/</span>sigma[<span class="dv">1</span>]</span>
<span id="cb124-34"><a href="#cb124-34" aria-hidden="true" tabindex="-1"></a>    Z[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb124-35"><a href="#cb124-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb124-36"><a href="#cb124-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Z)</span>
<span id="cb124-37"><a href="#cb124-37" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22088</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="co">#correlation</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="co">#mean</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="co">#unit standard deviations</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Gibbs by R</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">gibbsR</span>(mu,sigma,rho,N)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>dtR <span class="ot">&lt;-</span> Z[b<span class="sc">:</span>N, ]</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Gibbs by C++</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">gibbsC</span>(mu[<span class="dv">1</span>],sigma[<span class="dv">1</span>],mu[<span class="dv">2</span>],sigma[<span class="dv">2</span>],rho,N)</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>dtC <span class="ot">&lt;-</span> Z[b<span class="sc">:</span>N, ]</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a><span class="do">## QQ-plot</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(dtR[,<span class="dv">1</span>],dtC[,<span class="dv">1</span>],<span class="at">xlab =</span> <span class="st">&quot;Gibbs by R&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Gibbs by C++&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(dtR[,<span class="dv">2</span>],dtC[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;Gibbs by R&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Gibbs by C++&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="do">## computation time</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR=</span><span class="fu">gibbsR</span>(mu,sigma,rho,N),<span class="at">gibbsC=</span><span class="fu">gibbsC</span>(mu[<span class="dv">1</span>],sigma[<span class="dv">1</span>],mu[<span class="dv">2</span>],sigma[<span class="dv">2</span>],rho,N))</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr        lq    median        uq
## 1 gibbsR 25.201951 29.675051 32.044802
## 2 gibbsC  2.416551  2.502201  3.079152</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
